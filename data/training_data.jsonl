{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: True\nSame File: True\nDistance Lines: 7\nCode Context:\n@app.route(\"/\")\ndef index():\n    \"\"\"Home page.\"\"\"\n    return \"<h1>Vulnerable Test Application</h1>\"\n\n\n# CWE-89: SQL Injection\n@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": true, "in_same_file": true, "distance_lines": 7, "code_context": "@app.route(\"/\")\ndef index():\n    \"\"\"Home page.\"\"\"\n    return \"<h1>Vulnerable Test Application</h1>\"\n\n\n# CWE-89: SQL Injection\n@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 46, "sink_line": 53, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 28\nCode Context:\n@app.route(\"/\")\ndef index():\n    \"\"\"Home page.\"\"\"\n    return \"<h1>Vulnerable Test Application</h1>\"\n\n\n# CWE-89: SQL Injection\n@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n ", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 28, "code_context": "@app.route(\"/\")\ndef index():\n    \"\"\"Home page.\"\"\"\n    return \"<h1>Vulnerable Test Application</h1>\"\n\n\n# CWE-89: SQL Injection\n@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 46, "sink_line": 74, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: os.system(f\"ping -c 1 {host}\")\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 43\nCode Context:\n@app.route(\"/\")\ndef index():\n    \"\"\"Home page.\"\"\"\n    return \"<h1>Vulnerable Test Application</h1>\"\n\n\n# CWE-89: SQL Injection\n@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n ", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "os.system(f\"ping -c 1 {host}\")", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 43, "code_context": "@app.route(\"/\")\ndef index():\n    \"\"\"Home page.\"\"\"\n    return \"<h1>Vulnerable Test Application</h1>\"\n\n\n# CWE-89: SQL Injection\n@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 46, "sink_line": 89, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 178\nCode Context:\n@app.route(\"/\")\ndef index():\n    \"\"\"Home page.\"\"\"\n    return \"<h1>Vulnerable Test Application</h1>\"\n\n\n# CWE-89: SQL Injection\n@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n ", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 178, "code_context": "@app.route(\"/\")\ndef index():\n    \"\"\"Home page.\"\"\"\n    return \"<h1>Vulnerable Test Application</h1>\"\n\n\n# CWE-89: SQL Injection\n@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")\n\n    # VULNERABLE: User input rendered in template without escaping\n    template = f\"\"\"\n    <html>\n    <head><title>Profile</title></head>\n    <body>\n        <h1>User Profile</h1>\n        <div class=\"bio\">{bio}</div>\n    </body>\n    </html>\n    \"\"\"\n    return render_template_string(template)\n\n\n# CWE-22: Path Traversal\n@app.route(\"/download\")\ndef download_file():\n    \"\"\"Download file - VULNERABLE to Path Traversal.\"\"\"\n    filename = request.args.get(\"file\", \"\")\n\n    # VULNERABLE: No path sanitization\n    filepath = os.path.join(\"/var/www/files\", filename)\n\n    try:\n        with open(filepath, \"r\") as f:\n            content = f.read()\n        return content\n    except FileNotFoundError:\n        return \"File not found\"\n\n\n# CWE-22: Another Path Traversal variant\n@app.route(\"/view\")\ndef view_log():\n    \"\"\"View log file - VULNERABLE to Path Traversal.\"\"\"\n    log_name = request.args.get(\"log\", \"app.log\")\n\n    # VULNERABLE: User-controlled path without validation\n    log_path = f\"/var/log/{log_name}\"\n\n    with open(log_path, \"r\") as f:\n        return f.read()\n\n\n# CWE-502: Insecure Deserialization\n@app.route(\"/load\", methods=[\"POST\"])\ndef load_data():\n    \"\"\"Load serialized data - VULNERABLE to Insecure Deserialization.\"\"\"\n    data = request.get_data()\n\n    # VULNERABLE: Deserializing untrusted data\n    obj = pickle.loads(data)\n\n    return f\"Loaded object: {obj}\"\n\n\n# CWE-502: Another Deserialization variant\n@app.route(\"/session\")\ndef load_session():\n    \"\"\"Load session from cookie - VULNERABLE to Insecure Deserialization.\"\"\"\n    import base64\n\n    session_data = request.cookies.get(\"session\", \"\")\n\n    if session_data:\n        # VULNERABLE: Deserializing user-controlled session data\n        decoded = base64.b64decode(session_data)\n        session = pickle.loads(decoded)\n        return f\"Session: {session}\"\n\n    return \"No session\"\n\n\n# Additional vulnerability: Weak password hash\ndef hash_password(password):\n    \"\"\"Hash password - VULNERABLE: Using MD5.\"\"\"\n    import hashlib\n    return hashlib.md5(password.encode()).hexdigest()\n\n\n# Additional vulnerability: Debug mode enabled\ndef init_app():\n    \"\"\"Initialize application with insecure settings.\"\"\"\n    # VULNERABLE: Debug mode in production\n    app.debug = True\n    app.secret_key = \"development_key\"\n\n\nclass UserManager:\n    \"\"\"User management class with vulnerabilities.\"\"\"\n\n    def __init__(self):\n        # CWE-798: Hardcoded credentials in class\n        self.db_password = \"mysql_password_2024\"\n        self.admin_token = \"token_abc123xyz\"\n\n    def authenticate(self, username, password):\n        \"\"\"Authenticate user - VULNERABLE to SQL Injection.\"\"\"\n        conn = get_db_connection()\n        cursor = conn.cursor()\n\n        # VULNERABLE: SQL Injection in authentication\n        query = f\"SELECT * FROM users WHERE username='{username}' AND password='{password}'\"\n        cursor.execute(query)\n\n        user = cursor.fetchone()\n        conn.close()\n\n        return user is not None\n\n    def execute_command(self, cmd):\n        \"\"\"Execute system command - VULNERABLE to Command Injection.\"\"\"\n        # VULNERABLE: Executing user-provided command\n        return os.popen(cmd).read()", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 46, "sink_line": 224, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 14\nCode Context:\n@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 14, "code_context": "@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 67, "sink_line": 53, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: True\nSame File: True\nDistance Lines: 7\nCode Context:\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": true, "in_same_file": true, "distance_lines": 7, "code_context": "\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 67, "sink_line": 74, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: os.system(f\"ping -c 1 {host}\")\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 22\nCode Context:\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = re", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "os.system(f\"ping -c 1 {host}\")", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 22, "code_context": "\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 67, "sink_line": 89, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 157\nCode Context:\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = re", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 157, "code_context": "\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")\n\n    # VULNERABLE: User input rendered in template without escaping\n    template = f\"\"\"\n    <html>\n    <head><title>Profile</title></head>\n    <body>\n        <h1>User Profile</h1>\n        <div class=\"bio\">{bio}</div>\n    </body>\n    </html>\n    \"\"\"\n    return render_template_string(template)\n\n\n# CWE-22: Path Traversal\n@app.route(\"/download\")\ndef download_file():\n    \"\"\"Download file - VULNERABLE to Path Traversal.\"\"\"\n    filename = request.args.get(\"file\", \"\")\n\n    # VULNERABLE: No path sanitization\n    filepath = os.path.join(\"/var/www/files\", filename)\n\n    try:\n        with open(filepath, \"r\") as f:\n            content = f.read()\n        return content\n    except FileNotFoundError:\n        return \"File not found\"\n\n\n# CWE-22: Another Path Traversal variant\n@app.route(\"/view\")\ndef view_log():\n    \"\"\"View log file - VULNERABLE to Path Traversal.\"\"\"\n    log_name = request.args.get(\"log\", \"app.log\")\n\n    # VULNERABLE: User-controlled path without validation\n    log_path = f\"/var/log/{log_name}\"\n\n    with open(log_path, \"r\") as f:\n        return f.read()\n\n\n# CWE-502: Insecure Deserialization\n@app.route(\"/load\", methods=[\"POST\"])\ndef load_data():\n    \"\"\"Load serialized data - VULNERABLE to Insecure Deserialization.\"\"\"\n    data = request.get_data()\n\n    # VULNERABLE: Deserializing untrusted data\n    obj = pickle.loads(data)\n\n    return f\"Loaded object: {obj}\"\n\n\n# CWE-502: Another Deserialization variant\n@app.route(\"/session\")\ndef load_session():\n    \"\"\"Load session from cookie - VULNERABLE to Insecure Deserialization.\"\"\"\n    import base64\n\n    session_data = request.cookies.get(\"session\", \"\")\n\n    if session_data:\n        # VULNERABLE: Deserializing user-controlled session data\n        decoded = base64.b64decode(session_data)\n        session = pickle.loads(decoded)\n        return f\"Session: {session}\"\n\n    return \"No session\"\n\n\n# Additional vulnerability: Weak password hash\ndef hash_password(password):\n    \"\"\"Hash password - VULNERABLE: Using MD5.\"\"\"\n    import hashlib\n    return hashlib.md5(password.encode()).hexdigest()\n\n\n# Additional vulnerability: Debug mode enabled\ndef init_app():\n    \"\"\"Initialize application with insecure settings.\"\"\"\n    # VULNERABLE: Debug mode in production\n    app.debug = True\n    app.secret_key = \"development_key\"\n\n\nclass UserManager:\n    \"\"\"User management class with vulnerabilities.\"\"\"\n\n    def __init__(self):\n        # CWE-798: Hardcoded credentials in class\n        self.db_password = \"mysql_password_2024\"\n        self.admin_token = \"token_abc123xyz\"\n\n    def authenticate(self, username, password):\n        \"\"\"Authenticate user - VULNERABLE to SQL Injection.\"\"\"\n        conn = get_db_connection()\n        cursor = conn.cursor()\n\n        # VULNERABLE: SQL Injection in authentication\n        query = f\"SELECT * FROM users WHERE username='{username}' AND password='{password}'\"\n        cursor.execute(query)\n\n        user = cursor.fetchone()\n        conn.close()\n\n        return user is not None\n\n    def execute_command(self, cmd):\n        \"\"\"Execute system command - VULNERABLE to Command Injection.\"\"\"\n        # VULNERABLE: Executing user-provided command\n        return os.popen(cmd).read()", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 67, "sink_line": 224, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 33\nCode Context:\n@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a hos", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 33, "code_context": "@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 86, "sink_line": 53, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 12\nCode Context:\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 12, "code_context": "@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 86, "sink_line": 74, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: os.system(f\"ping -c 1 {host}\")\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: True\nSame File: True\nDistance Lines: 3\nCode Context:\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "os.system(f\"ping -c 1 {host}\")", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": true, "in_same_file": true, "distance_lines": 3, "code_context": "    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 86, "sink_line": 89, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 138\nCode Context:\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@ap", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 138, "code_context": "    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")\n\n    # VULNERABLE: User input rendered in template without escaping\n    template = f\"\"\"\n    <html>\n    <head><title>Profile</title></head>\n    <body>\n        <h1>User Profile</h1>\n        <div class=\"bio\">{bio}</div>\n    </body>\n    </html>\n    \"\"\"\n    return render_template_string(template)\n\n\n# CWE-22: Path Traversal\n@app.route(\"/download\")\ndef download_file():\n    \"\"\"Download file - VULNERABLE to Path Traversal.\"\"\"\n    filename = request.args.get(\"file\", \"\")\n\n    # VULNERABLE: No path sanitization\n    filepath = os.path.join(\"/var/www/files\", filename)\n\n    try:\n        with open(filepath, \"r\") as f:\n            content = f.read()\n        return content\n    except FileNotFoundError:\n        return \"File not found\"\n\n\n# CWE-22: Another Path Traversal variant\n@app.route(\"/view\")\ndef view_log():\n    \"\"\"View log file - VULNERABLE to Path Traversal.\"\"\"\n    log_name = request.args.get(\"log\", \"app.log\")\n\n    # VULNERABLE: User-controlled path without validation\n    log_path = f\"/var/log/{log_name}\"\n\n    with open(log_path, \"r\") as f:\n        return f.read()\n\n\n# CWE-502: Insecure Deserialization\n@app.route(\"/load\", methods=[\"POST\"])\ndef load_data():\n    \"\"\"Load serialized data - VULNERABLE to Insecure Deserialization.\"\"\"\n    data = request.get_data()\n\n    # VULNERABLE: Deserializing untrusted data\n    obj = pickle.loads(data)\n\n    return f\"Loaded object: {obj}\"\n\n\n# CWE-502: Another Deserialization variant\n@app.route(\"/session\")\ndef load_session():\n    \"\"\"Load session from cookie - VULNERABLE to Insecure Deserialization.\"\"\"\n    import base64\n\n    session_data = request.cookies.get(\"session\", \"\")\n\n    if session_data:\n        # VULNERABLE: Deserializing user-controlled session data\n        decoded = base64.b64decode(session_data)\n        session = pickle.loads(decoded)\n        return f\"Session: {session}\"\n\n    return \"No session\"\n\n\n# Additional vulnerability: Weak password hash\ndef hash_password(password):\n    \"\"\"Hash password - VULNERABLE: Using MD5.\"\"\"\n    import hashlib\n    return hashlib.md5(password.encode()).hexdigest()\n\n\n# Additional vulnerability: Debug mode enabled\ndef init_app():\n    \"\"\"Initialize application with insecure settings.\"\"\"\n    # VULNERABLE: Debug mode in production\n    app.debug = True\n    app.secret_key = \"development_key\"\n\n\nclass UserManager:\n    \"\"\"User management class with vulnerabilities.\"\"\"\n\n    def __init__(self):\n        # CWE-798: Hardcoded credentials in class\n        self.db_password = \"mysql_password_2024\"\n        self.admin_token = \"token_abc123xyz\"\n\n    def authenticate(self, username, password):\n        \"\"\"Authenticate user - VULNERABLE to SQL Injection.\"\"\"\n        conn = get_db_connection()\n        cursor = conn.cursor()\n\n        # VULNERABLE: SQL Injection in authentication\n        query = f\"SELECT * FROM users WHERE username='{username}' AND password='{password}'\"\n        cursor.execute(query)\n\n        user = cursor.fetchone()\n        conn.close()\n\n        return user is not None\n\n    def execute_command(self, cmd):\n        \"\"\"Execute system command - VULNERABLE to Command Injection.\"\"\"\n        # VULNERABLE: Executing user-provided command\n        return os.popen(cmd).read()", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 86, "sink_line": 224, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 45\nCode Context:\n@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a hos", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 45, "code_context": "@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 98, "sink_line": 53, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 24\nCode Context:\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 24, "code_context": "@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 98, "sink_line": 74, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: os.system(f\"ping -c 1 {host}\")\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 9\nCode Context:\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "os.system(f\"ping -c 1 {host}\")", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 9, "code_context": "    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 98, "sink_line": 89, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 126\nCode Context:\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")\n\n    # VULNERABLE: User input rendered in template without escaping\n    template = f\"\"\"\n    <html>\n    <head><title>Profile</title", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 126, "code_context": "    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")\n\n    # VULNERABLE: User input rendered in template without escaping\n    template = f\"\"\"\n    <html>\n    <head><title>Profile</title></head>\n    <body>\n        <h1>User Profile</h1>\n        <div class=\"bio\">{bio}</div>\n    </body>\n    </html>\n    \"\"\"\n    return render_template_string(template)\n\n\n# CWE-22: Path Traversal\n@app.route(\"/download\")\ndef download_file():\n    \"\"\"Download file - VULNERABLE to Path Traversal.\"\"\"\n    filename = request.args.get(\"file\", \"\")\n\n    # VULNERABLE: No path sanitization\n    filepath = os.path.join(\"/var/www/files\", filename)\n\n    try:\n        with open(filepath, \"r\") as f:\n            content = f.read()\n        return content\n    except FileNotFoundError:\n        return \"File not found\"\n\n\n# CWE-22: Another Path Traversal variant\n@app.route(\"/view\")\ndef view_log():\n    \"\"\"View log file - VULNERABLE to Path Traversal.\"\"\"\n    log_name = request.args.get(\"log\", \"app.log\")\n\n    # VULNERABLE: User-controlled path without validation\n    log_path = f\"/var/log/{log_name}\"\n\n    with open(log_path, \"r\") as f:\n        return f.read()\n\n\n# CWE-502: Insecure Deserialization\n@app.route(\"/load\", methods=[\"POST\"])\ndef load_data():\n    \"\"\"Load serialized data - VULNERABLE to Insecure Deserialization.\"\"\"\n    data = request.get_data()\n\n    # VULNERABLE: Deserializing untrusted data\n    obj = pickle.loads(data)\n\n    return f\"Loaded object: {obj}\"\n\n\n# CWE-502: Another Deserialization variant\n@app.route(\"/session\")\ndef load_session():\n    \"\"\"Load session from cookie - VULNERABLE to Insecure Deserialization.\"\"\"\n    import base64\n\n    session_data = request.cookies.get(\"session\", \"\")\n\n    if session_data:\n        # VULNERABLE: Deserializing user-controlled session data\n        decoded = base64.b64decode(session_data)\n        session = pickle.loads(decoded)\n        return f\"Session: {session}\"\n\n    return \"No session\"\n\n\n# Additional vulnerability: Weak password hash\ndef hash_password(password):\n    \"\"\"Hash password - VULNERABLE: Using MD5.\"\"\"\n    import hashlib\n    return hashlib.md5(password.encode()).hexdigest()\n\n\n# Additional vulnerability: Debug mode enabled\ndef init_app():\n    \"\"\"Initialize application with insecure settings.\"\"\"\n    # VULNERABLE: Debug mode in production\n    app.debug = True\n    app.secret_key = \"development_key\"\n\n\nclass UserManager:\n    \"\"\"User management class with vulnerabilities.\"\"\"\n\n    def __init__(self):\n        # CWE-798: Hardcoded credentials in class\n        self.db_password = \"mysql_password_2024\"\n        self.admin_token = \"token_abc123xyz\"\n\n    def authenticate(self, username, password):\n        \"\"\"Authenticate user - VULNERABLE to SQL Injection.\"\"\"\n        conn = get_db_connection()\n        cursor = conn.cursor()\n\n        # VULNERABLE: SQL Injection in authentication\n        query = f\"SELECT * FROM users WHERE username='{username}' AND password='{password}'\"\n        cursor.execute(query)\n\n        user = cursor.fetchone()\n        conn.close()\n\n        return user is not None\n\n    def execute_command(self, cmd):\n        \"\"\"Execute system command - VULNERABLE to Command Injection.\"\"\"\n        # VULNERABLE: Executing user-provided command\n        return os.popen(cmd).read()", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 98, "sink_line": 224, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 57\nCode Context:\n@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a hos", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 57, "code_context": "@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 110, "sink_line": 53, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 36\nCode Context:\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 36, "code_context": "@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 110, "sink_line": 74, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: os.system(f\"ping -c 1 {host}\")\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 21\nCode Context:\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User p", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "os.system(f\"ping -c 1 {host}\")", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 21, "code_context": "    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 110, "sink_line": 89, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 114\nCode Context:\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")\n\n    # VULNERABLE: User input rendered in template without escaping\n    template = f\"\"\"\n    <html>\n    <head><title>Profile</title></head>\n    <body>\n        <h1>User Profile</h1>\n        <div class=\"bio\">{bio}</div>\n    </body>\n    </html>\n    \"\"\"\n    return render_template_string(template)\n\n\n# CWE-22: Path Traversal\n@app.route(\"/download\")\ndef download_file():\n    \"\"\"Download file - VULNERABLE to Path Traversal.\"\"\"\n    filename = request.args.get(", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 114, "code_context": "    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")\n\n    # VULNERABLE: User input rendered in template without escaping\n    template = f\"\"\"\n    <html>\n    <head><title>Profile</title></head>\n    <body>\n        <h1>User Profile</h1>\n        <div class=\"bio\">{bio}</div>\n    </body>\n    </html>\n    \"\"\"\n    return render_template_string(template)\n\n\n# CWE-22: Path Traversal\n@app.route(\"/download\")\ndef download_file():\n    \"\"\"Download file - VULNERABLE to Path Traversal.\"\"\"\n    filename = request.args.get(\"file\", \"\")\n\n    # VULNERABLE: No path sanitization\n    filepath = os.path.join(\"/var/www/files\", filename)\n\n    try:\n        with open(filepath, \"r\") as f:\n            content = f.read()\n        return content\n    except FileNotFoundError:\n        return \"File not found\"\n\n\n# CWE-22: Another Path Traversal variant\n@app.route(\"/view\")\ndef view_log():\n    \"\"\"View log file - VULNERABLE to Path Traversal.\"\"\"\n    log_name = request.args.get(\"log\", \"app.log\")\n\n    # VULNERABLE: User-controlled path without validation\n    log_path = f\"/var/log/{log_name}\"\n\n    with open(log_path, \"r\") as f:\n        return f.read()\n\n\n# CWE-502: Insecure Deserialization\n@app.route(\"/load\", methods=[\"POST\"])\ndef load_data():\n    \"\"\"Load serialized data - VULNERABLE to Insecure Deserialization.\"\"\"\n    data = request.get_data()\n\n    # VULNERABLE: Deserializing untrusted data\n    obj = pickle.loads(data)\n\n    return f\"Loaded object: {obj}\"\n\n\n# CWE-502: Another Deserialization variant\n@app.route(\"/session\")\ndef load_session():\n    \"\"\"Load session from cookie - VULNERABLE to Insecure Deserialization.\"\"\"\n    import base64\n\n    session_data = request.cookies.get(\"session\", \"\")\n\n    if session_data:\n        # VULNERABLE: Deserializing user-controlled session data\n        decoded = base64.b64decode(session_data)\n        session = pickle.loads(decoded)\n        return f\"Session: {session}\"\n\n    return \"No session\"\n\n\n# Additional vulnerability: Weak password hash\ndef hash_password(password):\n    \"\"\"Hash password - VULNERABLE: Using MD5.\"\"\"\n    import hashlib\n    return hashlib.md5(password.encode()).hexdigest()\n\n\n# Additional vulnerability: Debug mode enabled\ndef init_app():\n    \"\"\"Initialize application with insecure settings.\"\"\"\n    # VULNERABLE: Debug mode in production\n    app.debug = True\n    app.secret_key = \"development_key\"\n\n\nclass UserManager:\n    \"\"\"User management class with vulnerabilities.\"\"\"\n\n    def __init__(self):\n        # CWE-798: Hardcoded credentials in class\n        self.db_password = \"mysql_password_2024\"\n        self.admin_token = \"token_abc123xyz\"\n\n    def authenticate(self, username, password):\n        \"\"\"Authenticate user - VULNERABLE to SQL Injection.\"\"\"\n        conn = get_db_connection()\n        cursor = conn.cursor()\n\n        # VULNERABLE: SQL Injection in authentication\n        query = f\"SELECT * FROM users WHERE username='{username}' AND password='{password}'\"\n        cursor.execute(query)\n\n        user = cursor.fetchone()\n        conn.close()\n\n        return user is not None\n\n    def execute_command(self, cmd):\n        \"\"\"Execute system command - VULNERABLE to Command Injection.\"\"\"\n        # VULNERABLE: Executing user-provided command\n        return os.popen(cmd).read()", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 110, "sink_line": 224, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 67\nCode Context:\n@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a hos", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 67, "code_context": "@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")\n\n    # VULNERABLE: User input rendered in template without escaping\n    template = f\"\"\"\n    <html>\n    <head><title>Profile</title></head>\n    <body>\n        <h1>User Profile</h1>\n        <div class=\"bio\">{bio}</div>\n    </body>\n    </html>", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 120, "sink_line": 53, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 46\nCode Context:\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 46, "code_context": "@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")\n\n    # VULNERABLE: User input rendered in template without escaping\n    template = f\"\"\"\n    <html>\n    <head><title>Profile</title></head>\n    <body>\n        <h1>User Profile</h1>\n        <div class=\"bio\">{bio}</div>\n    </body>\n    </html>", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 120, "sink_line": 74, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: os.system(f\"ping -c 1 {host}\")\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 31\nCode Context:\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User p", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "os.system(f\"ping -c 1 {host}\")", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 31, "code_context": "    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")\n\n    # VULNERABLE: User input rendered in template without escaping\n    template = f\"\"\"\n    <html>\n    <head><title>Profile</title></head>\n    <body>\n        <h1>User Profile</h1>\n        <div class=\"bio\">{bio}</div>\n    </body>\n    </html>", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 120, "sink_line": 89, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 104\nCode Context:\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")\n\n    # VULNERABLE: User input rendered in template without escaping\n    template = f\"\"\"\n    <html>\n    <head><title>Profile</title></head>\n    <body>\n        <h1>User Profile</h1>\n        <div class=\"bio\">{bio}</div>\n    </body>\n    </html>\n    \"\"\"\n    return render_template_string(template)\n\n\n# CWE-22: Path Traversal\n@app.route(\"/download\")\ndef download_file():\n    \"\"\"Download file - VULNERABLE to Path Traversal.\"\"\"\n    filename = request.args.get(\"file\", \"\")\n\n    # VULNERABLE: No path sanitization\n    filepath = os.path.join(\"/var/www/files\", filename)\n\n    try:\n        with open(filepath, \"r\") as f:\n            content = f.read()\n        return content\n    except FileNotFoundError:\n        ret", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 104, "code_context": "    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")\n\n    # VULNERABLE: User input rendered in template without escaping\n    template = f\"\"\"\n    <html>\n    <head><title>Profile</title></head>\n    <body>\n        <h1>User Profile</h1>\n        <div class=\"bio\">{bio}</div>\n    </body>\n    </html>\n    \"\"\"\n    return render_template_string(template)\n\n\n# CWE-22: Path Traversal\n@app.route(\"/download\")\ndef download_file():\n    \"\"\"Download file - VULNERABLE to Path Traversal.\"\"\"\n    filename = request.args.get(\"file\", \"\")\n\n    # VULNERABLE: No path sanitization\n    filepath = os.path.join(\"/var/www/files\", filename)\n\n    try:\n        with open(filepath, \"r\") as f:\n            content = f.read()\n        return content\n    except FileNotFoundError:\n        return \"File not found\"\n\n\n# CWE-22: Another Path Traversal variant\n@app.route(\"/view\")\ndef view_log():\n    \"\"\"View log file - VULNERABLE to Path Traversal.\"\"\"\n    log_name = request.args.get(\"log\", \"app.log\")\n\n    # VULNERABLE: User-controlled path without validation\n    log_path = f\"/var/log/{log_name}\"\n\n    with open(log_path, \"r\") as f:\n        return f.read()\n\n\n# CWE-502: Insecure Deserialization\n@app.route(\"/load\", methods=[\"POST\"])\ndef load_data():\n    \"\"\"Load serialized data - VULNERABLE to Insecure Deserialization.\"\"\"\n    data = request.get_data()\n\n    # VULNERABLE: Deserializing untrusted data\n    obj = pickle.loads(data)\n\n    return f\"Loaded object: {obj}\"\n\n\n# CWE-502: Another Deserialization variant\n@app.route(\"/session\")\ndef load_session():\n    \"\"\"Load session from cookie - VULNERABLE to Insecure Deserialization.\"\"\"\n    import base64\n\n    session_data = request.cookies.get(\"session\", \"\")\n\n    if session_data:\n        # VULNERABLE: Deserializing user-controlled session data\n        decoded = base64.b64decode(session_data)\n        session = pickle.loads(decoded)\n        return f\"Session: {session}\"\n\n    return \"No session\"\n\n\n# Additional vulnerability: Weak password hash\ndef hash_password(password):\n    \"\"\"Hash password - VULNERABLE: Using MD5.\"\"\"\n    import hashlib\n    return hashlib.md5(password.encode()).hexdigest()\n\n\n# Additional vulnerability: Debug mode enabled\ndef init_app():\n    \"\"\"Initialize application with insecure settings.\"\"\"\n    # VULNERABLE: Debug mode in production\n    app.debug = True\n    app.secret_key = \"development_key\"\n\n\nclass UserManager:\n    \"\"\"User management class with vulnerabilities.\"\"\"\n\n    def __init__(self):\n        # CWE-798: Hardcoded credentials in class\n        self.db_password = \"mysql_password_2024\"\n        self.admin_token = \"token_abc123xyz\"\n\n    def authenticate(self, username, password):\n        \"\"\"Authenticate user - VULNERABLE to SQL Injection.\"\"\"\n        conn = get_db_connection()\n        cursor = conn.cursor()\n\n        # VULNERABLE: SQL Injection in authentication\n        query = f\"SELECT * FROM users WHERE username='{username}' AND password='{password}'\"\n        cursor.execute(query)\n\n        user = cursor.fetchone()\n        conn.close()\n\n        return user is not None\n\n    def execute_command(self, cmd):\n        \"\"\"Execute system command - VULNERABLE to Command Injection.\"\"\"\n        # VULNERABLE: Executing user-provided command\n        return os.popen(cmd).read()", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 120, "sink_line": 224, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 86\nCode Context:\n@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a hos", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 86, "code_context": "@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")\n\n    # VULNERABLE: User input rendered in template without escaping\n    template = f\"\"\"\n    <html>\n    <head><title>Profile</title></head>\n    <body>\n        <h1>User Profile</h1>\n        <div class=\"bio\">{bio}</div>\n    </body>\n    </html>\n    \"\"\"\n    return render_template_string(template)\n\n\n# CWE-22: Path Traversal\n@app.route(\"/download\")\ndef download_file():\n    \"\"\"Download file - VULNERABLE to Path Traversal.\"\"\"\n    filename = request.args.get(\"file\", \"\")\n\n    # VULNERABLE: No path sanitization\n    filepath = os.path.join(\"/var/www/files\", filename)\n\n    try:\n        with open(filepath, \"r\") as f:\n            content = f.read()\n        return content\n    except FileNotFoundError:\n        return \"File not found\"", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 139, "sink_line": 53, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 65\nCode Context:\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 65, "code_context": "@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")\n\n    # VULNERABLE: User input rendered in template without escaping\n    template = f\"\"\"\n    <html>\n    <head><title>Profile</title></head>\n    <body>\n        <h1>User Profile</h1>\n        <div class=\"bio\">{bio}</div>\n    </body>\n    </html>\n    \"\"\"\n    return render_template_string(template)\n\n\n# CWE-22: Path Traversal\n@app.route(\"/download\")\ndef download_file():\n    \"\"\"Download file - VULNERABLE to Path Traversal.\"\"\"\n    filename = request.args.get(\"file\", \"\")\n\n    # VULNERABLE: No path sanitization\n    filepath = os.path.join(\"/var/www/files\", filename)\n\n    try:\n        with open(filepath, \"r\") as f:\n            content = f.read()\n        return content\n    except FileNotFoundError:\n        return \"File not found\"", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 139, "sink_line": 74, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: os.system(f\"ping -c 1 {host}\")\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 50\nCode Context:\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User p", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "os.system(f\"ping -c 1 {host}\")", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 50, "code_context": "    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")\n\n    # VULNERABLE: User input rendered in template without escaping\n    template = f\"\"\"\n    <html>\n    <head><title>Profile</title></head>\n    <body>\n        <h1>User Profile</h1>\n        <div class=\"bio\">{bio}</div>\n    </body>\n    </html>\n    \"\"\"\n    return render_template_string(template)\n\n\n# CWE-22: Path Traversal\n@app.route(\"/download\")\ndef download_file():\n    \"\"\"Download file - VULNERABLE to Path Traversal.\"\"\"\n    filename = request.args.get(\"file\", \"\")\n\n    # VULNERABLE: No path sanitization\n    filepath = os.path.join(\"/var/www/files\", filename)\n\n    try:\n        with open(filepath, \"r\") as f:\n            content = f.read()\n        return content\n    except FileNotFoundError:\n        return \"File not found\"", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 139, "sink_line": 89, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 85\nCode Context:\n    </body>\n    </html>\n    \"\"\"\n    return render_template_string(template)\n\n\n# CWE-22: Path Traversal\n@app.route(\"/download\")\ndef download_file():\n    \"\"\"Download file - VULNERABLE to Path Traversal.\"\"\"\n    filename = request.args.get(\"file\", \"\")\n\n    # VULNERABLE: No path sanitization\n    filepath = os.path.join(\"/var/www/files\", filename)\n\n    try:\n        with open(filepath, \"r\") as f:\n            content = f.read()\n        return content\n    except FileNotFoundError:\n        return \"File not found\"\n\n\n# CWE-22: Another Path Traversal variant\n@app.route(\"/view\")\ndef view_log():\n    \"\"\"View log file - VULNERABLE to Path Traversal.\"\"\"\n    log_name = request.args.get(\"log\", \"app.log\")\n\n    # VULNERABLE: User-controlled path without validation\n    log_path = f\"/var/log/{log_name}\"\n\n    with open(log_path, \"r\") as f:\n        return f.read()\n\n\n# CWE-502: Insecure Deserialization\n@app.route(\"/load\", methods=[\"POST\"])\ndef load_data():\n    \"\"\"Load serialized data - VULNERABLE to Insecure Des", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 85, "code_context": "    </body>\n    </html>\n    \"\"\"\n    return render_template_string(template)\n\n\n# CWE-22: Path Traversal\n@app.route(\"/download\")\ndef download_file():\n    \"\"\"Download file - VULNERABLE to Path Traversal.\"\"\"\n    filename = request.args.get(\"file\", \"\")\n\n    # VULNERABLE: No path sanitization\n    filepath = os.path.join(\"/var/www/files\", filename)\n\n    try:\n        with open(filepath, \"r\") as f:\n            content = f.read()\n        return content\n    except FileNotFoundError:\n        return \"File not found\"\n\n\n# CWE-22: Another Path Traversal variant\n@app.route(\"/view\")\ndef view_log():\n    \"\"\"View log file - VULNERABLE to Path Traversal.\"\"\"\n    log_name = request.args.get(\"log\", \"app.log\")\n\n    # VULNERABLE: User-controlled path without validation\n    log_path = f\"/var/log/{log_name}\"\n\n    with open(log_path, \"r\") as f:\n        return f.read()\n\n\n# CWE-502: Insecure Deserialization\n@app.route(\"/load\", methods=[\"POST\"])\ndef load_data():\n    \"\"\"Load serialized data - VULNERABLE to Insecure Deserialization.\"\"\"\n    data = request.get_data()\n\n    # VULNERABLE: Deserializing untrusted data\n    obj = pickle.loads(data)\n\n    return f\"Loaded object: {obj}\"\n\n\n# CWE-502: Another Deserialization variant\n@app.route(\"/session\")\ndef load_session():\n    \"\"\"Load session from cookie - VULNERABLE to Insecure Deserialization.\"\"\"\n    import base64\n\n    session_data = request.cookies.get(\"session\", \"\")\n\n    if session_data:\n        # VULNERABLE: Deserializing user-controlled session data\n        decoded = base64.b64decode(session_data)\n        session = pickle.loads(decoded)\n        return f\"Session: {session}\"\n\n    return \"No session\"\n\n\n# Additional vulnerability: Weak password hash\ndef hash_password(password):\n    \"\"\"Hash password - VULNERABLE: Using MD5.\"\"\"\n    import hashlib\n    return hashlib.md5(password.encode()).hexdigest()\n\n\n# Additional vulnerability: Debug mode enabled\ndef init_app():\n    \"\"\"Initialize application with insecure settings.\"\"\"\n    # VULNERABLE: Debug mode in production\n    app.debug = True\n    app.secret_key = \"development_key\"\n\n\nclass UserManager:\n    \"\"\"User management class with vulnerabilities.\"\"\"\n\n    def __init__(self):\n        # CWE-798: Hardcoded credentials in class\n        self.db_password = \"mysql_password_2024\"\n        self.admin_token = \"token_abc123xyz\"\n\n    def authenticate(self, username, password):\n        \"\"\"Authenticate user - VULNERABLE to SQL Injection.\"\"\"\n        conn = get_db_connection()\n        cursor = conn.cursor()\n\n        # VULNERABLE: SQL Injection in authentication\n        query = f\"SELECT * FROM users WHERE username='{username}' AND password='{password}'\"\n        cursor.execute(query)\n\n        user = cursor.fetchone()\n        conn.close()\n\n        return user is not None\n\n    def execute_command(self, cmd):\n        \"\"\"Execute system command - VULNERABLE to Command Injection.\"\"\"\n        # VULNERABLE: Executing user-provided command\n        return os.popen(cmd).read()", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 139, "sink_line": 224, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 103\nCode Context:\n@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a hos", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 103, "code_context": "@app.route(\"/user\")\ndef get_user():\n    \"\"\"Get user by ID - VULNERABLE to SQL Injection.\"\"\"\n    user_id = request.args.get(\"id\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: Direct string interpolation in SQL query\n    query = f\"SELECT * FROM users WHERE id = '{user_id}'\"\n    cursor.execute(query)\n\n    user = cursor.fetchone()\n    conn.close()\n\n    if user:\n        return f\"User: {user[1]}\"\n    return \"User not found\"\n\n\n# CWE-89: Another SQL Injection variant\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")\n\n    # VULNERABLE: User input rendered in template without escaping\n    template = f\"\"\"\n    <html>\n    <head><title>Profile</title></head>\n    <body>\n        <h1>User Profile</h1>\n        <div class=\"bio\">{bio}</div>\n    </body>\n    </html>\n    \"\"\"\n    return render_template_string(template)\n\n\n# CWE-22: Path Traversal\n@app.route(\"/download\")\ndef download_file():\n    \"\"\"Download file - VULNERABLE to Path Traversal.\"\"\"\n    filename = request.args.get(\"file\", \"\")\n\n    # VULNERABLE: No path sanitization\n    filepath = os.path.join(\"/var/www/files\", filename)\n\n    try:\n        with open(filepath, \"r\") as f:\n            content = f.read()\n        return content\n    except FileNotFoundError:\n        return \"File not found\"\n\n\n# CWE-22: Another Path Traversal variant\n@app.route(\"/view\")\ndef view_log():\n    \"\"\"View log file - VULNERABLE to Path Traversal.\"\"\"\n    log_name = request.args.get(\"log\", \"app.log\")\n\n    # VULNERABLE: User-controlled path without validation\n    log_path = f\"/var/log/{log_name}\"\n\n    with open(log_path, \"r\") as f:\n        return f.read()\n\n\n# CWE-502: Insecure Deserialization\n@app.route(\"/load\", methods=[\"POST\"])", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 156, "sink_line": 53, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 82\nCode Context:\n@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 82, "code_context": "@app.route(\"/search\")\ndef search_users():\n    \"\"\"Search users - VULNERABLE to SQL Injection.\"\"\"\n    name = request.args.get(\"name\", \"\")\n\n    conn = get_db_connection()\n    cursor = conn.cursor()\n\n    # VULNERABLE: String concatenation in SQL query\n    query = \"SELECT * FROM users WHERE name LIKE '%\" + name + \"%'\"\n    cursor.execute(query)\n\n    users = cursor.fetchall()\n    conn.close()\n\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")\n\n    # VULNERABLE: User input rendered in template without escaping\n    template = f\"\"\"\n    <html>\n    <head><title>Profile</title></head>\n    <body>\n        <h1>User Profile</h1>\n        <div class=\"bio\">{bio}</div>\n    </body>\n    </html>\n    \"\"\"\n    return render_template_string(template)\n\n\n# CWE-22: Path Traversal\n@app.route(\"/download\")\ndef download_file():\n    \"\"\"Download file - VULNERABLE to Path Traversal.\"\"\"\n    filename = request.args.get(\"file\", \"\")\n\n    # VULNERABLE: No path sanitization\n    filepath = os.path.join(\"/var/www/files\", filename)\n\n    try:\n        with open(filepath, \"r\") as f:\n            content = f.read()\n        return content\n    except FileNotFoundError:\n        return \"File not found\"\n\n\n# CWE-22: Another Path Traversal variant\n@app.route(\"/view\")\ndef view_log():\n    \"\"\"View log file - VULNERABLE to Path Traversal.\"\"\"\n    log_name = request.args.get(\"log\", \"app.log\")\n\n    # VULNERABLE: User-controlled path without validation\n    log_path = f\"/var/log/{log_name}\"\n\n    with open(log_path, \"r\") as f:\n        return f.read()\n\n\n# CWE-502: Insecure Deserialization\n@app.route(\"/load\", methods=[\"POST\"])", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 156, "sink_line": 74, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: os.system(f\"ping -c 1 {host}\")\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 67\nCode Context:\n    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User p", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "os.system(f\"ping -c 1 {host}\")", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 67, "code_context": "    return str(users)\n\n\n# CWE-78: OS Command Injection\n@app.route(\"/ping\")\ndef ping_host():\n    \"\"\"Ping a host - VULNERABLE to Command Injection.\"\"\"\n    host = request.args.get(\"host\", \"localhost\")\n\n    # VULNERABLE: User input directly in shell command\n    result = os.system(f\"ping -c 1 {host}\")\n\n    return f\"Ping result: {result}\"\n\n\n# CWE-78: Another Command Injection variant\n@app.route(\"/lookup\")\ndef dns_lookup():\n    \"\"\"DNS lookup - VULNERABLE to Command Injection.\"\"\"\n    domain = request.args.get(\"domain\", \"\")\n\n    # VULNERABLE: User input in subprocess command\n    output = subprocess.check_output(f\"nslookup {domain}\", shell=True)\n\n    return output.decode()\n\n\n# CWE-79: Reflected XSS\n@app.route(\"/greet\")\ndef greet():\n    \"\"\"Greet user - VULNERABLE to XSS.\"\"\"\n    name = request.args.get(\"name\", \"Guest\")\n\n    # VULNERABLE: User input directly in HTML response\n    return f\"<h1>Hello, {name}!</h1>\"\n\n\n# CWE-79: Stored XSS via template\n@app.route(\"/profile\")\ndef profile():\n    \"\"\"User profile - VULNERABLE to XSS.\"\"\"\n    bio = request.args.get(\"bio\", \"\")\n\n    # VULNERABLE: User input rendered in template without escaping\n    template = f\"\"\"\n    <html>\n    <head><title>Profile</title></head>\n    <body>\n        <h1>User Profile</h1>\n        <div class=\"bio\">{bio}</div>\n    </body>\n    </html>\n    \"\"\"\n    return render_template_string(template)\n\n\n# CWE-22: Path Traversal\n@app.route(\"/download\")\ndef download_file():\n    \"\"\"Download file - VULNERABLE to Path Traversal.\"\"\"\n    filename = request.args.get(\"file\", \"\")\n\n    # VULNERABLE: No path sanitization\n    filepath = os.path.join(\"/var/www/files\", filename)\n\n    try:\n        with open(filepath, \"r\") as f:\n            content = f.read()\n        return content\n    except FileNotFoundError:\n        return \"File not found\"\n\n\n# CWE-22: Another Path Traversal variant\n@app.route(\"/view\")\ndef view_log():\n    \"\"\"View log file - VULNERABLE to Path Traversal.\"\"\"\n    log_name = request.args.get(\"log\", \"app.log\")\n\n    # VULNERABLE: User-controlled path without validation\n    log_path = f\"/var/log/{log_name}\"\n\n    with open(log_path, \"r\") as f:\n        return f.read()\n\n\n# CWE-502: Insecure Deserialization\n@app.route(\"/load\", methods=[\"POST\"])", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 156, "sink_line": 89, "vulnerability_type": ""}
{"text": "Source: request.args.get\nSource Type: flask_request\nSink: cursor.execute(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 68\nCode Context:\n            content = f.read()\n        return content\n    except FileNotFoundError:\n        return \"File not found\"\n\n\n# CWE-22: Another Path Traversal variant\n@app.route(\"/view\")\ndef view_log():\n    \"\"\"View log file - VULNERABLE to Path Traversal.\"\"\"\n    log_name = request.args.get(\"log\", \"app.log\")\n\n    # VULNERABLE: User-controlled path without validation\n    log_path = f\"/var/log/{log_name}\"\n\n    with open(log_path, \"r\") as f:\n        return f.read()\n\n\n# CWE-502: Insecure Deserialization\n@app.route(\"/load\", methods=[\"POST\"])\ndef load_data():\n    \"\"\"Load serialized data - VULNERABLE to Insecure Deserialization.\"\"\"\n    data = request.get_data()\n\n    # VULNERABLE: Deserializing untrusted data\n    obj = pickle.loads(data)\n\n    return f\"Loaded object: {obj}\"\n\n\n# CWE-502: Another Deserialization variant\n@app.route(\"/session\")\ndef load_session():\n    \"\"\"Load session from cookie - VULNERABLE to Insecure Deserialization.\"\"\"\n    import base64\n\n    session_data = request.cookies.get(\"session\",", "label": 0, "source_expression": "request.args.get", "source_type": "flask_request", "sink_expression": "cursor.execute(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 68, "code_context": "            content = f.read()\n        return content\n    except FileNotFoundError:\n        return \"File not found\"\n\n\n# CWE-22: Another Path Traversal variant\n@app.route(\"/view\")\ndef view_log():\n    \"\"\"View log file - VULNERABLE to Path Traversal.\"\"\"\n    log_name = request.args.get(\"log\", \"app.log\")\n\n    # VULNERABLE: User-controlled path without validation\n    log_path = f\"/var/log/{log_name}\"\n\n    with open(log_path, \"r\") as f:\n        return f.read()\n\n\n# CWE-502: Insecure Deserialization\n@app.route(\"/load\", methods=[\"POST\"])\ndef load_data():\n    \"\"\"Load serialized data - VULNERABLE to Insecure Deserialization.\"\"\"\n    data = request.get_data()\n\n    # VULNERABLE: Deserializing untrusted data\n    obj = pickle.loads(data)\n\n    return f\"Loaded object: {obj}\"\n\n\n# CWE-502: Another Deserialization variant\n@app.route(\"/session\")\ndef load_session():\n    \"\"\"Load session from cookie - VULNERABLE to Insecure Deserialization.\"\"\"\n    import base64\n\n    session_data = request.cookies.get(\"session\", \"\")\n\n    if session_data:\n        # VULNERABLE: Deserializing user-controlled session data\n        decoded = base64.b64decode(session_data)\n        session = pickle.loads(decoded)\n        return f\"Session: {session}\"\n\n    return \"No session\"\n\n\n# Additional vulnerability: Weak password hash\ndef hash_password(password):\n    \"\"\"Hash password - VULNERABLE: Using MD5.\"\"\"\n    import hashlib\n    return hashlib.md5(password.encode()).hexdigest()\n\n\n# Additional vulnerability: Debug mode enabled\ndef init_app():\n    \"\"\"Initialize application with insecure settings.\"\"\"\n    # VULNERABLE: Debug mode in production\n    app.debug = True\n    app.secret_key = \"development_key\"\n\n\nclass UserManager:\n    \"\"\"User management class with vulnerabilities.\"\"\"\n\n    def __init__(self):\n        # CWE-798: Hardcoded credentials in class\n        self.db_password = \"mysql_password_2024\"\n        self.admin_token = \"token_abc123xyz\"\n\n    def authenticate(self, username, password):\n        \"\"\"Authenticate user - VULNERABLE to SQL Injection.\"\"\"\n        conn = get_db_connection()\n        cursor = conn.cursor()\n\n        # VULNERABLE: SQL Injection in authentication\n        query = f\"SELECT * FROM users WHERE username='{username}' AND password='{password}'\"\n        cursor.execute(query)\n\n        user = cursor.fetchone()\n        conn.close()\n\n        return user is not None\n\n    def execute_command(self, cmd):\n        \"\"\"Execute system command - VULNERABLE to Command Injection.\"\"\"\n        # VULNERABLE: Executing user-provided command\n        return os.popen(cmd).read()", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_app/app.py", "source_line": 156, "sink_line": 224, "vulnerability_type": ""}
{"text": "Source: req.query.q\nSource Type: request_query\nSink: app.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 1\nCode Context:\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(cookieParser());\n\n// Routes\napp.use('/api/users', usersRouter);\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)", "label": 1, "source_expression": "req.query.q", "source_type": "request_query", "sink_expression": "app.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 1, "code_context": "app.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(cookieParser());\n\n// Routes\napp.use('/api/users', usersRouter);\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/app.js", "source_line": 35, "sink_line": 34, "vulnerability_type": "CWE-79"}
{"text": "Source: req.query.q\nSource Type: request_query\nSink: app.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 5\nCode Context:\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(cookieParser());\n\n// Routes\napp.use('/api/users', usersRouter);\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();", "label": 1, "source_expression": "req.query.q", "source_type": "request_query", "sink_expression": "app.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 5, "code_context": "app.use(bodyParser.urlencoded({ extended: true }));\napp.use(cookieParser());\n\n// Routes\napp.use('/api/users', usersRouter);\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/app.js", "source_line": 35, "sink_line": 40, "vulnerability_type": "CWE-79"}
{"text": "Source: req.query.q\nSource Type: request_query\nSink: app.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.s\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 11\nCode Context:\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(cookieParser());\n\n// Routes\napp.use('/api/users', usersRouter);\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calcula", "label": 1, "source_expression": "req.query.q", "source_type": "request_query", "sink_expression": "app.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.s", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 11, "code_context": "app.use(bodyParser.urlencoded({ extended: true }));\napp.use(cookieParser());\n\n// Routes\napp.use('/api/users', usersRouter);\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/app.js", "source_line": 35, "sink_line": 46, "vulnerability_type": "CWE-918"}
{"text": "Source: req.query.q\nSource Type: request_query\nSink: fetch(url)\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 14\nCode Context:\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(cookieParser());\n\n// Routes\napp.use('/api/users', usersRouter);\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calcula", "label": 1, "source_expression": "req.query.q", "source_type": "request_query", "sink_expression": "fetch(url)", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 14, "code_context": "app.use(bodyParser.urlencoded({ extended: true }));\napp.use(cookieParser());\n\n// Routes\napp.use('/api/users', usersRouter);\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/app.js", "source_line": 35, "sink_line": 49, "vulnerability_type": "CWE-918"}
{"text": "Source: req.query.q\nSource Type: request_query\nSink: app.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 20\nCode Context:\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(cookieParser());\n\n// Routes\napp.use('/api/users', usersRouter);\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calcula", "label": 1, "source_expression": "req.query.q", "source_type": "request_query", "sink_expression": "app.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 20, "code_context": "app.use(bodyParser.urlencoded({ extended: true }));\napp.use(cookieParser());\n\n// Routes\napp.use('/api/users', usersRouter);\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});\n\n// Login endpoint with JWT\napp.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    // Simplified auth - in real app would check database\n    if (username && password) {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/app.js", "source_line": 35, "sink_line": 55, "vulnerability_type": "CWE-94"}
{"text": "Source: req.query.q\nSource Type: request_query\nSink: app.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    // Simplified auth - in real app would check database\n    if (username && password) {\n        const token = jw\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 27\nCode Context:\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(cookieParser());\n\n// Routes\napp.use('/api/users', usersRouter);\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calcula", "label": 0, "source_expression": "req.query.q", "source_type": "request_query", "sink_expression": "app.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    // Simplified auth - in real app would check database\n    if (username && password) {\n        const token = jw", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 27, "code_context": "app.use(bodyParser.urlencoded({ extended: true }));\napp.use(cookieParser());\n\n// Routes\napp.use('/api/users', usersRouter);\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});\n\n// Login endpoint with JWT\napp.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    // Simplified auth - in real app would check database\n    if (username && password) {\n        const token = jwt.sign({ username }, JWT_SECRET, { expiresIn: '1h' });\n        res.json({ token });\n    } else {\n        res.status(401).json({ error: 'Invalid credentials' });\n    }\n});\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/app.js", "source_line": 35, "sink_line": 62, "vulnerability_type": ""}
{"text": "Source: req.query.url\nSource Type: request_query\nSink: app.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 13\nCode Context:\napp.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(cookieParser());\n\n// Routes\napp.use('/api/users', usersRouter);\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval ", "label": 1, "source_expression": "req.query.url", "source_type": "request_query", "sink_expression": "app.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 13, "code_context": "app.use(bodyParser.json());\napp.use(bodyParser.urlencoded({ extended: true }));\napp.use(cookieParser());\n\n// Routes\napp.use('/api/users', usersRouter);\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/app.js", "source_line": 47, "sink_line": 34, "vulnerability_type": "CWE-79"}
{"text": "Source: req.query.url\nSource Type: request_query\nSink: app.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 7\nCode Context:\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);", "label": 1, "source_expression": "req.query.url", "source_type": "request_query", "sink_expression": "app.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 7, "code_context": "app.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/app.js", "source_line": 47, "sink_line": 40, "vulnerability_type": "CWE-79"}
{"text": "Source: req.query.url\nSource Type: request_query\nSink: app.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.s\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 1\nCode Context:\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);", "label": 1, "source_expression": "req.query.url", "source_type": "request_query", "sink_expression": "app.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.s", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 1, "code_context": "    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/app.js", "source_line": 47, "sink_line": 46, "vulnerability_type": "CWE-918"}
{"text": "Source: req.query.url\nSource Type: request_query\nSink: fetch(url)\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: True\nSame File: True\nDistance Lines: 2\nCode Context:\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});", "label": 1, "source_expression": "req.query.url", "source_type": "request_query", "sink_expression": "fetch(url)", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": true, "in_same_file": true, "distance_lines": 2, "code_context": "});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/app.js", "source_line": 47, "sink_line": 49, "vulnerability_type": "CWE-918"}
{"text": "Source: req.query.url\nSource Type: request_query\nSink: app.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 8\nCode Context:\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});\n\n// Login endpoint with JWT\napp.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    // Simplified auth - in real app would check database\n    if (username && password) {", "label": 1, "source_expression": "req.query.url", "source_type": "request_query", "sink_expression": "app.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 8, "code_context": "});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});\n\n// Login endpoint with JWT\napp.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    // Simplified auth - in real app would check database\n    if (username && password) {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/app.js", "source_line": 47, "sink_line": 55, "vulnerability_type": "CWE-94"}
{"text": "Source: req.query.url\nSource Type: request_query\nSink: app.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    // Simplified auth - in real app would check database\n    if (username && password) {\n        const token = jw\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 15\nCode Context:\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});\n\n// Login endpoint with JWT\napp.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    // Simplified auth - in real app would check database\n    if (username && password) {\n        const token = jwt.sign({ username }, JWT_SECRET, { expiresIn: '1h' });\n  ", "label": 0, "source_expression": "req.query.url", "source_type": "request_query", "sink_expression": "app.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    // Simplified auth - in real app would check database\n    if (username && password) {\n        const token = jw", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 15, "code_context": "});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});\n\n// Login endpoint with JWT\napp.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    // Simplified auth - in real app would check database\n    if (username && password) {\n        const token = jwt.sign({ username }, JWT_SECRET, { expiresIn: '1h' });\n        res.json({ token });\n    } else {\n        res.status(401).json({ error: 'Invalid credentials' });\n    }\n});\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/app.js", "source_line": 47, "sink_line": 62, "vulnerability_type": ""}
{"text": "Source: req.body.expression\nSource Type: request_body\nSink: res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`)\nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 20\nCode Context:\napp.use(cookieParser());\n\n// Routes\napp.use('/api/users', usersRouter);\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body", "label": 1, "source_expression": "req.body.expression", "source_type": "request_body", "sink_expression": "res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`)", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 20, "code_context": "app.use(cookieParser());\n\n// Routes\napp.use('/api/users', usersRouter);\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});\n\n// Login endpoint with JWT\napp.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    // Simplified auth - in real app would check database\n    if (username && password) {\n        const token = jwt.sign({ username }, JWT_SECRET, { expiresIn: '1h' });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/app.js", "source_line": 56, "sink_line": 36, "vulnerability_type": "CWE-79"}
{"text": "Source: req.body.expression\nSource Type: request_body\nSink: res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`)\nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 14\nCode Context:\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});\n\n// Login endpoint with JWT\napp.post('/login', async (req, res) => {\n    const { usern", "label": 1, "source_expression": "req.body.expression", "source_type": "request_body", "sink_expression": "res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`)", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 14, "code_context": "\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});\n\n// Login endpoint with JWT\napp.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    // Simplified auth - in real app would check database\n    if (username && password) {\n        const token = jwt.sign({ username }, JWT_SECRET, { expiresIn: '1h' });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/app.js", "source_line": 56, "sink_line": 42, "vulnerability_type": "CWE-79"}
{"text": "Source: req.body.expression\nSource Type: request_body\nSink: res.send(data)\nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 5\nCode Context:\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});\n\n// Login endpoint with JWT\napp.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    // Simplified auth - in real app would check database\n    if (username && password) {\n        const token = jwt.sign({ username }, JWT_SECRET, { expiresIn: '1h' });", "label": 0, "source_expression": "req.body.expression", "source_type": "request_body", "sink_expression": "res.send(data)", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 5, "code_context": "    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});\n\n// Login endpoint with JWT\napp.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    // Simplified auth - in real app would check database\n    if (username && password) {\n        const token = jwt.sign({ username }, JWT_SECRET, { expiresIn: '1h' });", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/app.js", "source_line": 56, "sink_line": 51, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`)\nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 27\nCode Context:\napp.use(cookieParser());\n\n// Routes\napp.use('/api/users', usersRouter);\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`)", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 27, "code_context": "app.use(cookieParser());\n\n// Routes\napp.use('/api/users', usersRouter);\napp.use('/api/products', productsRouter);\napp.use('/api/admin', authMiddleware, adminRouter);\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});\n\n// Login endpoint with JWT\napp.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    // Simplified auth - in real app would check database\n    if (username && password) {\n        const token = jwt.sign({ username }, JWT_SECRET, { expiresIn: '1h' });\n        res.json({ token });\n    } else {\n        res.status(401).json({ error: 'Invalid credentials' });\n    }\n});\n\nconst PORT = process.env.PORT || 3000;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/app.js", "source_line": 63, "sink_line": 36, "vulnerability_type": "CWE-79"}
{"text": "Source: req.body\nSource Type: request_body\nSink: res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`)\nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 21\nCode Context:\n\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});\n\n// Login endpoint with JWT\napp.post('/login', async (req, res) => {\n    const { usern", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`)", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 21, "code_context": "\n// VULNERABILITY: CWE-79 - Reflected XSS (Line 34)\napp.get('/search', (req, res) => {\n    const query = req.query.q;\n    res.send(`<html><body><h1>Search results for: ${query}</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-79 - Reflected XSS via parameter (Line 40)\napp.get('/welcome/:name', (req, res) => {\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});\n\n// Login endpoint with JWT\napp.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    // Simplified auth - in real app would check database\n    if (username && password) {\n        const token = jwt.sign({ username }, JWT_SECRET, { expiresIn: '1h' });\n        res.json({ token });\n    } else {\n        res.status(401).json({ error: 'Invalid credentials' });\n    }\n});\n\nconst PORT = process.env.PORT || 3000;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/app.js", "source_line": 63, "sink_line": 42, "vulnerability_type": "CWE-79"}
{"text": "Source: req.body\nSource Type: request_body\nSink: res.send(data)\nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 12\nCode Context:\n    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});\n\n// Login endpoint with JWT\napp.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    // Simplified auth - in real app would check database\n    if (username && password) {\n        const token = jwt.sign({ username }, JWT_SECRET, { expiresIn: '1h' });\n        res.json({ token });\n    } else {\n        res.status(401).json({ error: 'Invalid credentials' });\n    }\n})", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "res.send(data)", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 12, "code_context": "    const name = req.params.name;\n    res.send(`<html><body><h1>Welcome, ${name}!</h1></body></html>`);\n});\n\n// VULNERABILITY: CWE-918 - SSRF via user-controlled URL (Line 46)\napp.get('/fetch', async (req, res) => {\n    const url = req.query.url;\n    const fetch = require('node-fetch');\n    const response = await fetch(url);\n    const data = await response.text();\n    res.send(data);\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via eval (Line 55)\napp.post('/calculate', (req, res) => {\n    const expression = req.body.expression;\n    const result = eval(expression);\n    res.json({ result });\n});\n\n// Login endpoint with JWT\napp.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    // Simplified auth - in real app would check database\n    if (username && password) {\n        const token = jwt.sign({ username }, JWT_SECRET, { expiresIn: '1h' });\n        res.json({ token });\n    } else {\n        res.status(401).json({ error: 'Invalid credentials' });\n    }\n});\n\nconst PORT = process.env.PORT || 3000;", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/app.js", "source_line": 63, "sink_line": 51, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ succes\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: True\nSame File: True\nDistance Lines: 1\nCode Context:\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ succes", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": true, "in_same_file": true, "distance_lines": 1, "code_context": " */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 13, "sink_line": 14, "vulnerability_type": "CWE-78"}
{"text": "Source: req.body\nSource Type: request_body\nSink: execSync(command)\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 13\nCode Context:\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spa", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "execSync(command)", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 13, "code_context": " */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 13, "sink_line": 26, "vulnerability_type": "CWE-78"}
{"text": "Source: req.body\nSource Type: request_body\nSink: spawn('convert', [inputFile, outputFile])\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 20\nCode Context:\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spa", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "spawn('convert', [inputFile, outputFile])", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 20, "code_context": " */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 13, "sink_line": 33, "vulnerability_type": "CWE-78"}
{"text": "Source: req.body\nSource Type: request_body\nSink: exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    })\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 29\nCode Context:\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spa", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    })", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 29, "code_context": " */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 13, "sink_line": 42, "vulnerability_type": "CWE-78"}
{"text": "Source: req.body\nSource Type: request_body\nSink: res.send(content)\nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 39\nCode Context:\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spa", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "res.send(content)", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 39, "code_context": " */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 13, "sink_line": 52, "vulnerability_type": "CWE-22"}
{"text": "Source: req.body\nSource Type: request_body\nSink: exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    })\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 60\nCode Context:\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spa", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    })", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 60, "code_context": " */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 13, "sink_line": 73, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.cmd\nSource Type: request_query\nSink: router.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.statu\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 13\nCode Context:\n * Admin Route - Contains Command Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const {", "label": 1, "source_expression": "req.query.cmd", "source_type": "request_query", "sink_expression": "router.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.statu", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 13, "code_context": " * Admin Route - Contains Command Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 25, "sink_line": 12, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.cmd\nSource Type: request_query\nSink: exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ succes\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 11\nCode Context:\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('", "label": 1, "source_expression": "req.query.cmd", "source_type": "request_query", "sink_expression": "exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ succes", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 11, "code_context": "\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 25, "sink_line": 14, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.cmd\nSource Type: request_query\nSink: router.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 1\nCode Context:\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });", "label": 1, "source_expression": "req.query.cmd", "source_type": "request_query", "sink_expression": "router.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 1, "code_context": "    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 25, "sink_line": 24, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.cmd\nSource Type: request_query\nSink: execSync(command)\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: False\nSame Function: True\nSame File: True\nDistance Lines: 1\nCode Context:\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });", "label": 1, "source_expression": "req.query.cmd", "source_type": "request_query", "sink_expression": "execSync(command)", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": false, "in_same_function": true, "in_same_file": true, "distance_lines": 1, "code_context": "        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 25, "sink_line": 26, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.cmd\nSource Type: request_query\nSink: router.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.j\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 6\nCode Context:\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;", "label": 1, "source_expression": "req.query.cmd", "source_type": "request_query", "sink_expression": "router.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.j", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 6, "code_context": "        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 25, "sink_line": 31, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.cmd\nSource Type: request_query\nSink: spawn('convert', [inputFile, outputFile])\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 8\nCode Context:\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });", "label": 1, "source_expression": "req.query.cmd", "source_type": "request_query", "sink_expression": "spawn('convert', [inputFile, outputFile])", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 8, "code_context": "        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 25, "sink_line": 33, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.cmd\nSource Type: request_query\nSink: router.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 15\nCode Context:\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-", "label": 1, "source_expression": "req.query.cmd", "source_type": "request_query", "sink_expression": "router.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 15, "code_context": "        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 25, "sink_line": 40, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.cmd\nSource Type: request_query\nSink: exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    })\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 17\nCode Context:\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-", "label": 1, "source_expression": "req.query.cmd", "source_type": "request_query", "sink_expression": "exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    })", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 17, "code_context": "        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 25, "sink_line": 42, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.cmd\nSource Type: request_query\nSink: router.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 23\nCode Context:\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-", "label": 1, "source_expression": "req.query.cmd", "source_type": "request_query", "sink_expression": "router.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 23, "code_context": "        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 25, "sink_line": 48, "vulnerability_type": "CWE-22"}
{"text": "Source: req.query.cmd\nSource Type: request_query\nSink: router.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 31\nCode Context:\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-", "label": 1, "source_expression": "req.query.cmd", "source_type": "request_query", "sink_expression": "router.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 31, "code_context": "        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 25, "sink_line": 56, "vulnerability_type": "CWE-22"}
{"text": "Source: req.query.cmd\nSource Type: request_query\nSink: router.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json(\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 38\nCode Context:\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-", "label": 1, "source_expression": "req.query.cmd", "source_type": "request_query", "sink_expression": "router.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json(", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 38, "code_context": "        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 25, "sink_line": 63, "vulnerability_type": "CWE-22"}
{"text": "Source: req.query.cmd\nSource Type: request_query\nSink: router.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !er\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 46\nCode Context:\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-", "label": 1, "source_expression": "req.query.cmd", "source_type": "request_query", "sink_expression": "router.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !er", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 46, "code_context": "        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 25, "sink_line": 71, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.cmd\nSource Type: request_query\nSink: exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    })\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 48\nCode Context:\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-", "label": 1, "source_expression": "req.query.cmd", "source_type": "request_query", "sink_expression": "exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    })", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 48, "code_context": "        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 25, "sink_line": 73, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.cmd\nSource Type: request_query\nSink: router.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 54\nCode Context:\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-", "label": 1, "source_expression": "req.query.cmd", "source_type": "request_query", "sink_expression": "router.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 54, "code_context": "        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 25, "sink_line": 79, "vulnerability_type": "CWE-22"}
{"text": "Source: req.body\nSource Type: request_body\nSink: exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ succes\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 18\nCode Context:\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ succes", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 18, "code_context": "\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 32, "sink_line": 14, "vulnerability_type": "CWE-78"}
{"text": "Source: req.body\nSource Type: request_body\nSink: execSync(command)\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 6\nCode Context:\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "execSync(command)", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 6, "code_context": "            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 32, "sink_line": 26, "vulnerability_type": "CWE-78"}
{"text": "Source: req.body\nSource Type: request_body\nSink: spawn('convert', [inputFile, outputFile])\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: False\nSame Function: True\nSame File: True\nDistance Lines: 1\nCode Context:\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "spawn('convert', [inputFile, outputFile])", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": false, "in_same_function": true, "in_same_file": true, "distance_lines": 1, "code_context": "\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 32, "sink_line": 33, "vulnerability_type": "CWE-78"}
{"text": "Source: req.body\nSource Type: request_body\nSink: exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    })\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 10\nCode Context:\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n ", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    })", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 10, "code_context": "\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 32, "sink_line": 42, "vulnerability_type": "CWE-78"}
{"text": "Source: req.body\nSource Type: request_body\nSink: res.send(content)\nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 20\nCode Context:\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n ", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "res.send(content)", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 20, "code_context": "\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 32, "sink_line": 52, "vulnerability_type": "CWE-22"}
{"text": "Source: req.body\nSource Type: request_body\nSink: exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    })\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 41\nCode Context:\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n ", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    })", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 41, "code_context": "\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 32, "sink_line": 73, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.host\nSource Type: request_query\nSink: router.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.statu\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 29\nCode Context:\n * Admin Route - Contains Command Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const {", "label": 1, "source_expression": "req.query.host", "source_type": "request_query", "sink_expression": "router.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.statu", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 29, "code_context": " * Admin Route - Contains Command Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 41, "sink_line": 12, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.host\nSource Type: request_query\nSink: exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ succes\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 27\nCode Context:\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('", "label": 1, "source_expression": "req.query.host", "source_type": "request_query", "sink_expression": "exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ succes", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 27, "code_context": "\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 41, "sink_line": 14, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.host\nSource Type: request_query\nSink: router.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 17\nCode Context:\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n      ", "label": 1, "source_expression": "req.query.host", "source_type": "request_query", "sink_expression": "router.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 17, "code_context": "    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 41, "sink_line": 24, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.host\nSource Type: request_query\nSink: execSync(command)\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 15\nCode Context:\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal i", "label": 1, "source_expression": "req.query.host", "source_type": "request_query", "sink_expression": "execSync(command)", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 15, "code_context": "            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 41, "sink_line": 26, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.host\nSource Type: request_query\nSink: router.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.j\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 10\nCode Context:\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename", "label": 1, "source_expression": "req.query.host", "source_type": "request_query", "sink_expression": "router.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.j", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 10, "code_context": "});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 41, "sink_line": 31, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.host\nSource Type: request_query\nSink: spawn('convert', [inputFile, outputFile])\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 8\nCode Context:\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n  ", "label": 1, "source_expression": "req.query.host", "source_type": "request_query", "sink_expression": "spawn('convert', [inputFile, outputFile])", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 8, "code_context": "// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 41, "sink_line": 33, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.host\nSource Type: request_query\nSink: router.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 1\nCode Context:\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');", "label": 1, "source_expression": "req.query.host", "source_type": "request_query", "sink_expression": "router.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 1, "code_context": "// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 41, "sink_line": 40, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.host\nSource Type: request_query\nSink: exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    })\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: True\nSame File: True\nDistance Lines: 1\nCode Context:\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);", "label": 1, "source_expression": "req.query.host", "source_type": "request_query", "sink_expression": "exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    })", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": true, "in_same_file": true, "distance_lines": 1, "code_context": "router.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 41, "sink_line": 42, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.host\nSource Type: request_query\nSink: router.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 7\nCode Context:\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;", "label": 1, "source_expression": "req.query.host", "source_type": "request_query", "sink_expression": "router.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 7, "code_context": "router.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 41, "sink_line": 48, "vulnerability_type": "CWE-22"}
{"text": "Source: req.query.host\nSource Type: request_query\nSink: router.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 15\nCode Context:\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePat", "label": 1, "source_expression": "req.query.host", "source_type": "request_query", "sink_expression": "router.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 15, "code_context": "router.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 41, "sink_line": 56, "vulnerability_type": "CWE-22"}
{"text": "Source: req.query.host\nSource Type: request_query\nSink: router.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json(\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 22\nCode Context:\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePat", "label": 1, "source_expression": "req.query.host", "source_type": "request_query", "sink_expression": "router.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json(", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 22, "code_context": "router.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 41, "sink_line": 63, "vulnerability_type": "CWE-22"}
{"text": "Source: req.query.host\nSource Type: request_query\nSink: router.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !er\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 30\nCode Context:\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePat", "label": 1, "source_expression": "req.query.host", "source_type": "request_query", "sink_expression": "router.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !er", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 30, "code_context": "router.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 41, "sink_line": 71, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.host\nSource Type: request_query\nSink: exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    })\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 32\nCode Context:\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePat", "label": 1, "source_expression": "req.query.host", "source_type": "request_query", "sink_expression": "exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    })", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 32, "code_context": "router.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 41, "sink_line": 73, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.host\nSource Type: request_query\nSink: router.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 38\nCode Context:\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePat", "label": 1, "source_expression": "req.query.host", "source_type": "request_query", "sink_expression": "router.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 38, "code_context": "router.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 41, "sink_line": 79, "vulnerability_type": "CWE-22"}
{"text": "Source: req.query.file\nSource Type: request_query\nSink: router.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.statu\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 37\nCode Context:\n * Admin Route - Contains Command Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const {", "label": 1, "source_expression": "req.query.file", "source_type": "request_query", "sink_expression": "router.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.statu", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 37, "code_context": " * Admin Route - Contains Command Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 49, "sink_line": 12, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.file\nSource Type: request_query\nSink: exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ succes\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 35\nCode Context:\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('", "label": 1, "source_expression": "req.query.file", "source_type": "request_query", "sink_expression": "exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ succes", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 35, "code_context": "\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 49, "sink_line": 14, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.file\nSource Type: request_query\nSink: router.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 25\nCode Context:\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n      ", "label": 1, "source_expression": "req.query.file", "source_type": "request_query", "sink_expression": "router.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 25, "code_context": "    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 49, "sink_line": 24, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.file\nSource Type: request_query\nSink: execSync(command)\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 23\nCode Context:\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal i", "label": 1, "source_expression": "req.query.file", "source_type": "request_query", "sink_expression": "execSync(command)", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 23, "code_context": "            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 49, "sink_line": 26, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.file\nSource Type: request_query\nSink: router.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.j\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 18\nCode Context:\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename", "label": 1, "source_expression": "req.query.file", "source_type": "request_query", "sink_expression": "router.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.j", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 18, "code_context": "});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 49, "sink_line": 31, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.file\nSource Type: request_query\nSink: spawn('convert', [inputFile, outputFile])\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 16\nCode Context:\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n  ", "label": 1, "source_expression": "req.query.file", "source_type": "request_query", "sink_expression": "spawn('convert', [inputFile, outputFile])", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 16, "code_context": "// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 49, "sink_line": 33, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.file\nSource Type: request_query\nSink: router.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 9\nCode Context:\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const", "label": 1, "source_expression": "req.query.file", "source_type": "request_query", "sink_expression": "router.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 9, "code_context": "// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 49, "sink_line": 40, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.file\nSource Type: request_query\nSink: exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    })\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 7\nCode Context:\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);", "label": 1, "source_expression": "req.query.file", "source_type": "request_query", "sink_expression": "exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    })", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 7, "code_context": "    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 49, "sink_line": 42, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.file\nSource Type: request_query\nSink: router.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 1\nCode Context:\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);", "label": 1, "source_expression": "req.query.file", "source_type": "request_query", "sink_expression": "router.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 1, "code_context": "\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 49, "sink_line": 48, "vulnerability_type": "CWE-22"}
{"text": "Source: req.query.file\nSource Type: request_query\nSink: router.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 7\nCode Context:\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(con", "label": 1, "source_expression": "req.query.file", "source_type": "request_query", "sink_expression": "router.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 7, "code_context": "// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 49, "sink_line": 56, "vulnerability_type": "CWE-22"}
{"text": "Source: req.query.file\nSource Type: request_query\nSink: router.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json(\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 14\nCode Context:\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(con", "label": 1, "source_expression": "req.query.file", "source_type": "request_query", "sink_expression": "router.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json(", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 14, "code_context": "// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 49, "sink_line": 63, "vulnerability_type": "CWE-22"}
{"text": "Source: req.query.file\nSource Type: request_query\nSink: router.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !er\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 22\nCode Context:\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(con", "label": 1, "source_expression": "req.query.file", "source_type": "request_query", "sink_expression": "router.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !er", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 22, "code_context": "// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 49, "sink_line": 71, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.file\nSource Type: request_query\nSink: exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    })\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 24\nCode Context:\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(con", "label": 1, "source_expression": "req.query.file", "source_type": "request_query", "sink_expression": "exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    })", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 24, "code_context": "// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 49, "sink_line": 73, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.file\nSource Type: request_query\nSink: router.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 30\nCode Context:\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(con", "label": 1, "source_expression": "req.query.file", "source_type": "request_query", "sink_expression": "router.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 30, "code_context": "// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 49, "sink_line": 79, "vulnerability_type": "CWE-22"}
{"text": "Source: req.query.path\nSource Type: request_query\nSink: router.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.statu\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 45\nCode Context:\n * Admin Route - Contains Command Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const {", "label": 1, "source_expression": "req.query.path", "source_type": "request_query", "sink_expression": "router.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.statu", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 45, "code_context": " * Admin Route - Contains Command Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 57, "sink_line": 12, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.path\nSource Type: request_query\nSink: exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ succes\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 43\nCode Context:\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('", "label": 1, "source_expression": "req.query.path", "source_type": "request_query", "sink_expression": "exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ succes", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 43, "code_context": "\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 57, "sink_line": 14, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.path\nSource Type: request_query\nSink: router.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 33\nCode Context:\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n      ", "label": 1, "source_expression": "req.query.path", "source_type": "request_query", "sink_expression": "router.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 33, "code_context": "    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 57, "sink_line": 24, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.path\nSource Type: request_query\nSink: execSync(command)\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 31\nCode Context:\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal i", "label": 1, "source_expression": "req.query.path", "source_type": "request_query", "sink_expression": "execSync(command)", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 31, "code_context": "            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 57, "sink_line": 26, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.path\nSource Type: request_query\nSink: router.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.j\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 26\nCode Context:\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename", "label": 1, "source_expression": "req.query.path", "source_type": "request_query", "sink_expression": "router.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.j", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 26, "code_context": "});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 57, "sink_line": 31, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.path\nSource Type: request_query\nSink: spawn('convert', [inputFile, outputFile])\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 24\nCode Context:\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n  ", "label": 1, "source_expression": "req.query.path", "source_type": "request_query", "sink_expression": "spawn('convert', [inputFile, outputFile])", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 24, "code_context": "// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 57, "sink_line": 33, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.path\nSource Type: request_query\nSink: router.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 17\nCode Context:\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const", "label": 1, "source_expression": "req.query.path", "source_type": "request_query", "sink_expression": "router.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 17, "code_context": "// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 57, "sink_line": 40, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.path\nSource Type: request_query\nSink: exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    })\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 15\nCode Context:\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path", "label": 1, "source_expression": "req.query.path", "source_type": "request_query", "sink_expression": "exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    })", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 15, "code_context": "    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 57, "sink_line": 42, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.path\nSource Type: request_query\nSink: router.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 9\nCode Context:\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(co", "label": 1, "source_expression": "req.query.path", "source_type": "request_query", "sink_expression": "router.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 9, "code_context": "\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 57, "sink_line": 48, "vulnerability_type": "CWE-22"}
{"text": "Source: req.query.path\nSource Type: request_query\nSink: router.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 1\nCode Context:\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });", "label": 1, "source_expression": "req.query.path", "source_type": "request_query", "sink_expression": "router.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 1, "code_context": "\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 57, "sink_line": 56, "vulnerability_type": "CWE-22"}
{"text": "Source: req.query.path\nSource Type: request_query\nSink: router.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json(\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 6\nCode Context:\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl}", "label": 1, "source_expression": "req.query.path", "source_type": "request_query", "sink_expression": "router.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json(", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 6, "code_context": "// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 57, "sink_line": 63, "vulnerability_type": "CWE-22"}
{"text": "Source: req.query.path\nSource Type: request_query\nSink: router.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !er\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 14\nCode Context:\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl}", "label": 1, "source_expression": "req.query.path", "source_type": "request_query", "sink_expression": "router.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !er", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 14, "code_context": "// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 57, "sink_line": 71, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.path\nSource Type: request_query\nSink: exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    })\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 16\nCode Context:\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl}", "label": 1, "source_expression": "req.query.path", "source_type": "request_query", "sink_expression": "exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    })", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 16, "code_context": "// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 57, "sink_line": 73, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.path\nSource Type: request_query\nSink: router.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 22\nCode Context:\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl}", "label": 1, "source_expression": "req.query.path", "source_type": "request_query", "sink_expression": "router.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 22, "code_context": "// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 57, "sink_line": 79, "vulnerability_type": "CWE-22"}
{"text": "Source: req.body\nSource Type: request_body\nSink: exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ succes\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 50\nCode Context:\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ succes", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 50, "code_context": "\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 64, "sink_line": 14, "vulnerability_type": "CWE-78"}
{"text": "Source: req.body\nSource Type: request_body\nSink: execSync(command)\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 38\nCode Context:\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal i", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "execSync(command)", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 38, "code_context": "            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 64, "sink_line": 26, "vulnerability_type": "CWE-78"}
{"text": "Source: req.body\nSource Type: request_body\nSink: spawn('convert', [inputFile, outputFile])\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 31\nCode Context:\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n  ", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "spawn('convert', [inputFile, outputFile])", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 31, "code_context": "// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 64, "sink_line": 33, "vulnerability_type": "CWE-78"}
{"text": "Source: req.body\nSource Type: request_body\nSink: exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    })\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 22\nCode Context:\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    })", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 22, "code_context": "    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 64, "sink_line": 42, "vulnerability_type": "CWE-78"}
{"text": "Source: req.body\nSource Type: request_body\nSink: res.send(content)\nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 12\nCode Context:\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.p", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "res.send(content)", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 12, "code_context": "    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 64, "sink_line": 52, "vulnerability_type": "CWE-22"}
{"text": "Source: req.body\nSource Type: request_body\nSink: exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    })\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 9\nCode Context:\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir ||", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    })", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 9, "code_context": "\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 64, "sink_line": 73, "vulnerability_type": "CWE-78"}
{"text": "Source: req.body\nSource Type: request_body\nSink: exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ succes\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 58\nCode Context:\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ succes", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 58, "code_context": "\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 72, "sink_line": 14, "vulnerability_type": "CWE-78"}
{"text": "Source: req.body\nSource Type: request_body\nSink: execSync(command)\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 46\nCode Context:\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal i", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "execSync(command)", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 46, "code_context": "            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 72, "sink_line": 26, "vulnerability_type": "CWE-78"}
{"text": "Source: req.body\nSource Type: request_body\nSink: spawn('convert', [inputFile, outputFile])\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 39\nCode Context:\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n  ", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "spawn('convert', [inputFile, outputFile])", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 39, "code_context": "// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 72, "sink_line": 33, "vulnerability_type": "CWE-78"}
{"text": "Source: req.body\nSource Type: request_body\nSink: exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    })\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 30\nCode Context:\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    })", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 30, "code_context": "    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 72, "sink_line": 42, "vulnerability_type": "CWE-78"}
{"text": "Source: req.body\nSource Type: request_body\nSink: res.send(content)\nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 20\nCode Context:\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.p", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "res.send(content)", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 20, "code_context": "    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 72, "sink_line": 52, "vulnerability_type": "CWE-22"}
{"text": "Source: req.body\nSource Type: request_body\nSink: exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    })\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: True\nSame File: True\nDistance Lines: 1\nCode Context:\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    })", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": true, "in_same_file": true, "distance_lines": 1, "code_context": "// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 72, "sink_line": 73, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.dir\nSource Type: request_query\nSink: router.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.statu\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 68\nCode Context:\n * Admin Route - Contains Command Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const {", "label": 1, "source_expression": "req.query.dir", "source_type": "request_query", "sink_expression": "router.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.statu", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 68, "code_context": " * Admin Route - Contains Command Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 80, "sink_line": 12, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.dir\nSource Type: request_query\nSink: exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ succes\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 66\nCode Context:\n\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('", "label": 1, "source_expression": "req.query.dir", "source_type": "request_query", "sink_expression": "exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ succes", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 66, "code_context": "\nconst express = require('express');\nconst router = express.Router();\nconst { exec, spawn, execSync } = require('child_process');\nconst fs = require('fs');\nconst path = require('path');\n\n// VULNERABILITY: CWE-78 - Command Injection via exec (Line 13)\nrouter.post('/backup', (req, res) => {\n    const { filename } = req.body;\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 80, "sink_line": 14, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.dir\nSource Type: request_query\nSink: router.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 56\nCode Context:\n    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n      ", "label": 1, "source_expression": "req.query.dir", "source_type": "request_query", "sink_expression": "router.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 56, "code_context": "    exec(`tar -czf /backups/${filename}.tar.gz /data`, (error, stdout, stderr) => {\n        if (error) {\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 80, "sink_line": 24, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.dir\nSource Type: request_query\nSink: execSync(command)\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 54\nCode Context:\n            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal i", "label": 1, "source_expression": "req.query.dir", "source_type": "request_query", "sink_expression": "execSync(command)", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 54, "code_context": "            res.status(500).json({ error: stderr });\n        } else {\n            res.json({ success: true, output: stdout });\n        }\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 80, "sink_line": 26, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.dir\nSource Type: request_query\nSink: router.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.j\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 49\nCode Context:\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename", "label": 1, "source_expression": "req.query.dir", "source_type": "request_query", "sink_expression": "router.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.j", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 49, "code_context": "});\n\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 80, "sink_line": 31, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.dir\nSource Type: request_query\nSink: spawn('convert', [inputFile, outputFile])\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 47\nCode Context:\n// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n  ", "label": 1, "source_expression": "req.query.dir", "source_type": "request_query", "sink_expression": "spawn('convert', [inputFile, outputFile])", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 47, "code_context": "// VULNERABILITY: CWE-78 - Command Injection via execSync (Line 25)\nrouter.get('/system-info', (req, res) => {\n    const command = req.query.cmd || 'uname -a';\n    const output = execSync(command).toString();\n    res.json({ output });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 80, "sink_line": 33, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.dir\nSource Type: request_query\nSink: router.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 40\nCode Context:\n// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const", "label": 1, "source_expression": "req.query.dir", "source_type": "request_query", "sink_expression": "router.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 40, "code_context": "// VULNERABILITY: CWE-78 - Command Injection via spawn (Line 32)\nrouter.post('/convert', (req, res) => {\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 80, "sink_line": 40, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.dir\nSource Type: request_query\nSink: exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    })\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 38\nCode Context:\n    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path", "label": 1, "source_expression": "req.query.dir", "source_type": "request_query", "sink_expression": "exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    })", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 38, "code_context": "    const { inputFile, outputFile } = req.body;\n    const process = spawn('convert', [inputFile, outputFile]);\n    process.on('close', (code) => {\n        res.json({ success: code === 0 });\n    });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 80, "sink_line": 42, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.dir\nSource Type: request_query\nSink: router.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 32\nCode Context:\n\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(co", "label": 1, "source_expression": "req.query.dir", "source_type": "request_query", "sink_expression": "router.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 32, "code_context": "\n// VULNERABILITY: CWE-78 - Command Injection in ping utility (Line 41)\nrouter.get('/ping', (req, res) => {\n    const host = req.query.host;\n    exec(`ping -c 4 ${host}`, (error, stdout) => {\n        res.json({ output: stdout || error.message });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 80, "sink_line": 48, "vulnerability_type": "CWE-22"}
{"text": "Source: req.query.dir\nSource Type: request_query\nSink: router.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 24\nCode Context:\n\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl", "label": 1, "source_expression": "req.query.dir", "source_type": "request_query", "sink_expression": "router.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 24, "code_context": "\n// VULNERABILITY: CWE-22 - Path Traversal in file read (Line 49)\nrouter.get('/logs', (req, res) => {\n    const filename = req.query.file;\n    const logPath = path.join('/var/log', filename);\n    const content = fs.readFileSync(logPath, 'utf8');\n    res.send(content);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 80, "sink_line": 56, "vulnerability_type": "CWE-22"}
{"text": "Source: req.query.dir\nSource Type: request_query\nSink: router.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json(\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 17\nCode Context:\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.di", "label": 1, "source_expression": "req.query.dir", "source_type": "request_query", "sink_expression": "router.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json(", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 17, "code_context": "});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file download (Line 57)\nrouter.get('/download', (req, res) => {\n    const requestedFile = req.query.path;\n    const filePath = `/uploads/${requestedFile}`;\n    res.download(filePath);\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 80, "sink_line": 63, "vulnerability_type": "CWE-22"}
{"text": "Source: req.query.dir\nSource Type: request_query\nSink: router.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !er\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 9\nCode Context:\n\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label": 1, "source_expression": "req.query.dir", "source_type": "request_query", "sink_expression": "router.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !er", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 9, "code_context": "\n// VULNERABILITY: CWE-22 - Path Traversal in file write (Line 64)\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 80, "sink_line": 71, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.dir\nSource Type: request_query\nSink: exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    })\nSink Type: command_exec\nCWE Types: CWE-78\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 7\nCode Context:\nrouter.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label": 1, "source_expression": "req.query.dir", "source_type": "request_query", "sink_expression": "exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    })", "sink_type": "command_exec", "cwe_types": ["CWE-78"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 7, "code_context": "router.post('/save-config', (req, res) => {\n    const { filename, content } = req.body;\n    const configPath = path.join('/configs', filename);\n    fs.writeFileSync(configPath, content);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 80, "sink_line": 73, "vulnerability_type": "CWE-78"}
{"text": "Source: req.query.dir\nSource Type: request_query\nSink: router.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n})\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 1\nCode Context:\n\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label": 1, "source_expression": "req.query.dir", "source_type": "request_query", "sink_expression": "router.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n})", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 1, "code_context": "\n// VULNERABILITY: CWE-78 - Command Injection via shell parameter (Line 72)\nrouter.post('/git-clone', (req, res) => {\n    const { repoUrl, branch } = req.body;\n    exec(`git clone -b ${branch} ${repoUrl} /tmp/repo`, (error, stdout, stderr) => {\n        res.json({ success: !error, output: stdout, error: stderr });\n    });\n});\n\n// VULNERABILITY: CWE-22 - Path Traversal in directory listing (Line 80)\nrouter.get('/list-files', (req, res) => {\n    const dir = req.query.dir || '/uploads';\n    const files = fs.readdirSync(dir);\n    res.json({ files });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/admin.js", "source_line": 80, "sink_line": 79, "vulnerability_type": "CWE-22"}
{"text": "Source: req.query\nSource Type: request_query\nSink: router.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPric\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 1\nCode Context:\n/**\n * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {", "label": 1, "source_expression": "req.query", "source_type": "request_query", "sink_expression": "router.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPric", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 1, "code_context": "/**\n * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 12, "sink_line": 11, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query\nSource Type: request_query\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: True\nSame File: True\nDistance Lines: 2\nCode Context:\n * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>", "label": 1, "source_expression": "req.query", "source_type": "request_query", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": true, "in_same_file": true, "distance_lines": 2, "code_context": " * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 12, "sink_line": 14, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query\nSource Type: request_query\nSink: router.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n \nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 7\nCode Context:\n * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product", "label": 1, "source_expression": "req.query", "source_type": "request_query", "sink_expression": "router.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n ", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 7, "code_context": " * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 12, "sink_line": 19, "vulnerability_type": "CWE-79"}
{"text": "Source: req.query\nSource Type: request_query\nSink: sequelize.query(`SELECT * FROM products WHERE id = ${productId}`)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 9\nCode Context:\n * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product", "label": 1, "source_expression": "req.query", "source_type": "request_query", "sink_expression": "sequelize.query(`SELECT * FROM products WHERE id = ${productId}`)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 9, "code_context": " * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 12, "sink_line": 21, "vulnerability_type": "CWE-79"}
{"text": "Source: req.query\nSource Type: request_query\nSink: router.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image.\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 25\nCode Context:\n * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product", "label": 1, "source_expression": "req.query", "source_type": "request_query", "sink_expression": "router.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image.", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 25, "code_context": " * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 12, "sink_line": 37, "vulnerability_type": "CWE-918"}
{"text": "Source: req.query\nSource Type: request_query\nSink: fetch(imageUrl)\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 27\nCode Context:\n * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product", "label": 1, "source_expression": "req.query", "source_type": "request_query", "sink_expression": "fetch(imageUrl)", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 27, "code_context": " * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 12, "sink_line": 39, "vulnerability_type": "CWE-918"}
{"text": "Source: req.query\nSource Type: request_query\nSink: router.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 34\nCode Context:\n * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product", "label": 1, "source_expression": "req.query", "source_type": "request_query", "sink_expression": "router.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 34, "code_context": " * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 12, "sink_line": 46, "vulnerability_type": "CWE-918"}
{"text": "Source: req.query\nSource Type: request_query\nSink: fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    })\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 36\nCode Context:\n * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product", "label": 1, "source_expression": "req.query", "source_type": "request_query", "sink_expression": "fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    })", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 36, "code_context": " * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 12, "sink_line": 48, "vulnerability_type": "CWE-918"}
{"text": "Source: req.query\nSource Type: request_query\nSink: router.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 45\nCode Context:\n * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product", "label": 1, "source_expression": "req.query", "source_type": "request_query", "sink_expression": "router.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 45, "code_context": " * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 12, "sink_line": 57, "vulnerability_type": "CWE-94"}
{"text": "Source: req.query\nSource Type: request_query\nSink: router.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await \nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 54\nCode Context:\n * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product", "label": 1, "source_expression": "req.query", "source_type": "request_query", "sink_expression": "router.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await ", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 54, "code_context": " * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 12, "sink_line": 66, "vulnerability_type": "CWE-79"}
{"text": "Source: req.query\nSource Type: request_query\nSink: sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    )\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 58\nCode Context:\n * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product", "label": 0, "source_expression": "req.query", "source_type": "request_query", "sink_expression": "sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    )", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 58, "code_context": " * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 12, "sink_line": 70, "vulnerability_type": ""}
{"text": "Source: req.query\nSource Type: request_query\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 69\nCode Context:\n * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product", "label": 0, "source_expression": "req.query", "source_type": "request_query", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 69, "code_context": " * Products Route - Contains XSS and SSRF vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 12, "sink_line": 81, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 6\nCode Context:\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 6, "code_context": "\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 20, "sink_line": 14, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(`SELECT * FROM products WHERE id = ${productId}`)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: True\nSame Function: True\nSame File: True\nDistance Lines: 1\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(`SELECT * FROM products WHERE id = ${productId}`)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": true, "in_same_function": true, "in_same_file": true, "distance_lines": 1, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 20, "sink_line": 21, "vulnerability_type": "CWE-79"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    )\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 50\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nroute", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    )", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 50, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 20, "sink_line": 70, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 61\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nroute", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 61, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 20, "sink_line": 81, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 24\nCode Context:\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 24, "code_context": "\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 38, "sink_line": 14, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(`SELECT * FROM products WHERE id = ${productId}`)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 17\nCode Context:\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } ", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(`SELECT * FROM products WHERE id = ${productId}`)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 17, "code_context": "router.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 38, "sink_line": 21, "vulnerability_type": "CWE-79"}
{"text": "Source: req.body\nSource Type: request_body\nSink: res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        \nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 15\nCode Context:\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffe", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        ", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 15, "code_context": "    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 38, "sink_line": 23, "vulnerability_type": "CWE-79"}
{"text": "Source: req.body\nSource Type: request_body\nSink: res.status(404).send('Product not found')\nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 6\nCode Context:\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "res.status(404).send('Product not found')", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 6, "code_context": "    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 38, "sink_line": 32, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    )\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 32\nCode Context:\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    )", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 32, "code_context": "                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 38, "sink_line": 70, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 43\nCode Context:\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 43, "code_context": "                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 38, "sink_line": 81, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 33\nCode Context:\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 33, "code_context": "\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 47, "sink_line": 14, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(`SELECT * FROM products WHERE id = ${productId}`)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 26\nCode Context:\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } ", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(`SELECT * FROM products WHERE id = ${productId}`)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 26, "code_context": "router.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 47, "sink_line": 21, "vulnerability_type": "CWE-79"}
{"text": "Source: req.body\nSource Type: request_body\nSink: res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        \nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 24\nCode Context:\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffe", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        ", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 24, "code_context": "    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 47, "sink_line": 23, "vulnerability_type": "CWE-79"}
{"text": "Source: req.body\nSource Type: request_body\nSink: res.status(404).send('Product not found')\nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 15\nCode Context:\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "res.status(404).send('Product not found')", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 15, "code_context": "    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 47, "sink_line": 32, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    )\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 23\nCode Context:\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review conte", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    )", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 23, "code_context": "router.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 47, "sink_line": 70, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 34\nCode Context:\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review conte", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 34, "code_context": "router.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 47, "sink_line": 81, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 44\nCode Context:\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 44, "code_context": "\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 58, "sink_line": 14, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(`SELECT * FROM products WHERE id = ${productId}`)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 37\nCode Context:\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } ", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(`SELECT * FROM products WHERE id = ${productId}`)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 37, "code_context": "router.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 58, "sink_line": 21, "vulnerability_type": "CWE-79"}
{"text": "Source: req.body\nSource Type: request_body\nSink: res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        \nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 35\nCode Context:\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffe", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        ", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 35, "code_context": "    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 58, "sink_line": 23, "vulnerability_type": "CWE-79"}
{"text": "Source: req.body\nSource Type: request_body\nSink: res.status(404).send('Product not found')\nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 26\nCode Context:\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "res.status(404).send('Product not found')", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 26, "code_context": "    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 58, "sink_line": 32, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    )\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 12\nCode Context:\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injec", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    )", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 12, "code_context": "    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 58, "sink_line": 70, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 23\nCode Context:\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injec", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 23, "code_context": "    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 58, "sink_line": 81, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 53\nCode Context:\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 53, "code_context": "\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 67, "sink_line": 14, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(`SELECT * FROM products WHERE id = ${productId}`)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 46\nCode Context:\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } ", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(`SELECT * FROM products WHERE id = ${productId}`)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 46, "code_context": "router.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 67, "sink_line": 21, "vulnerability_type": "CWE-79"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    )\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: True\nSame Function: True\nSame File: True\nDistance Lines: 3\nCode Context:\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    )", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": true, "in_same_function": true, "in_same_file": true, "distance_lines": 3, "code_context": "router.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 67, "sink_line": 70, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 14\nCode Context:\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;\n    await sequelize.query(query);\n    res.json({ succes", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 14, "code_context": "router.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 67, "sink_line": 81, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 54\nCode Context:\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 54, "code_context": "\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 68, "sink_line": 14, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(`SELECT * FROM products WHERE id = ${productId}`)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 47\nCode Context:\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } ", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(`SELECT * FROM products WHERE id = ${productId}`)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 47, "code_context": "router.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 68, "sink_line": 21, "vulnerability_type": "CWE-79"}
{"text": "Source: req.body\nSource Type: request_body\nSink: res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        \nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 45\nCode Context:\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffe", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        ", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 45, "code_context": "    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 68, "sink_line": 23, "vulnerability_type": "CWE-79"}
{"text": "Source: req.body\nSource Type: request_body\nSink: res.status(404).send('Product not found')\nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 36\nCode Context:\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "res.status(404).send('Product not found')", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 36, "code_context": "    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 68, "sink_line": 32, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    )\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: True\nSame Function: True\nSame File: True\nDistance Lines: 2\nCode Context:\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    )", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": true, "in_same_function": true, "in_same_file": true, "distance_lines": 2, "code_context": "    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 68, "sink_line": 70, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 13\nCode Context:\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\nmodule.exports = router;\n", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 13, "code_context": "    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 68, "sink_line": 81, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 64\nCode Context:\n\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 64, "code_context": "\nconst express = require('express');\nconst router = express.Router();\nconst fetch = require('node-fetch');\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection in product search (Line 12)\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 78, "sink_line": 14, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(`SELECT * FROM products WHERE id = ${productId}`)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 57\nCode Context:\nrouter.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } ", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(`SELECT * FROM products WHERE id = ${productId}`)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 57, "code_context": "router.get('/search', async (req, res) => {\n    const { category, minPrice, maxPrice } = req.query;\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 78, "sink_line": 21, "vulnerability_type": "CWE-79"}
{"text": "Source: req.body\nSource Type: request_body\nSink: res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        \nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 55\nCode Context:\n    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffe", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        ", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 55, "code_context": "    const query = `SELECT * FROM products WHERE category = '${category}' AND price BETWEEN ${minPrice} AND ${maxPrice}`;\n    const products = await sequelize.query(query);\n    res.json(products);\n});\n\n// VULNERABILITY: CWE-79 - XSS in product description rendering (Line 20)\nrouter.get('/:id/render', async (req, res) => {\n    const productId = req.params.id;\n    const [product] = await sequelize.query(`SELECT * FROM products WHERE id = ${productId}`);\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 78, "sink_line": 23, "vulnerability_type": "CWE-79"}
{"text": "Source: req.body\nSource Type: request_body\nSink: res.status(404).send('Product not found')\nSink Type: response_write\nCWE Types: CWE-79\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 46\nCode Context:\n    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "res.status(404).send('Product not found')", "sink_type": "response_write", "cwe_types": ["CWE-79"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 46, "code_context": "    if (product) {\n        res.send(`\n            <html>\n                <body>\n                    <h1>${product.name}</h1>\n                    <p>${product.description}</p>\n                </body>\n            </html>\n        `);\n    } else {\n        res.status(404).send('Product not found');\n    }\n});\n\n// VULNERABILITY: CWE-918 - SSRF via product image URL (Line 36)\nrouter.post('/import-image', async (req, res) => {\n    const { imageUrl } = req.body;\n    const response = await fetch(imageUrl);\n    const imageBuffer = await response.buffer();\n    // Process image...\n    res.json({ success: true, size: imageBuffer.length });\n});\n\n// VULNERABILITY: CWE-918 - SSRF via webhook URL (Line 45)\nrouter.post('/webhook', async (req, res) => {\n    const { webhookUrl, payload } = req.body;\n    await fetch(webhookUrl, {\n        method: 'POST',\n        body: JSON.stringify(payload),\n        headers: { 'Content-Type': 'application/json' }\n    });\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-94 - Code Injection via template (Line 56)\nrouter.post('/format-price', (req, res) => {\n    const { template, price } = req.body;\n    // Dangerous: allows arbitrary code execution\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 78, "sink_line": 32, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    )\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 8\nCode Context:\n    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\nmodule.exports = router;\n", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    )", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 8, "code_context": "    const formatFn = new Function('price', `return ${template}`);\n    const formatted = formatFn(price);\n    res.json({ formatted });\n});\n\n// VULNERABILITY: CWE-79 - XSS in review content (Line 65)\nrouter.post('/:id/reviews', async (req, res) => {\n    const productId = req.params.id;\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 78, "sink_line": 70, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: True\nSame File: True\nDistance Lines: 3\nCode Context:\n    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\nmodule.exports = router;\n", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": true, "in_same_file": true, "distance_lines": 3, "code_context": "    const { content, rating } = req.body;\n    // Content stored without sanitization, rendered as HTML\n    await sequelize.query(\n        `INSERT INTO reviews (product_id, content, rating) VALUES (${productId}, '${content}', ${rating})`\n    );\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in bulk delete (Line 76)\nrouter.delete('/bulk', async (req, res) => {\n    const { ids } = req.body;\n    const idList = ids.join(',');\n    const query = `DELETE FROM products WHERE id IN (${idList})`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/products.js", "source_line": 78, "sink_line": 81, "vulnerability_type": ""}
{"text": "Source: req.query.name\nSource Type: request_query\nSink: router.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(qu\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 1\nCode Context:\n/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);", "label": 1, "source_expression": "req.query.name", "source_type": "request_query", "sink_expression": "router.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(qu", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 1, "code_context": "/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 11, "sink_line": 10, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query.name\nSource Type: request_query\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: True\nSame File: True\nDistance Lines: 2\nCode Context:\n/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});", "label": 1, "source_expression": "req.query.name", "source_type": "request_query", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": true, "in_same_file": true, "distance_lines": 2, "code_context": "/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 11, "sink_line": 13, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query.name\nSource Type: request_query\nSink: router.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(use\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 7\nCode Context:\n/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND ", "label": 1, "source_expression": "req.query.name", "source_type": "request_query", "sink_expression": "router.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(use", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 7, "code_context": "/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 11, "sink_line": 18, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query.name\nSource Type: request_query\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 10\nCode Context:\n/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND ", "label": 1, "source_expression": "req.query.name", "source_type": "request_query", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 10, "code_context": "/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 11, "sink_line": 21, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query.name\nSource Type: request_query\nSink: router.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const \nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 15\nCode Context:\n/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND ", "label": 1, "source_expression": "req.query.name", "source_type": "request_query", "sink_expression": "router.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const ", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 15, "code_context": "/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 11, "sink_line": 26, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query.name\nSource Type: request_query\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 18\nCode Context:\n/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND ", "label": 1, "source_expression": "req.query.name", "source_type": "request_query", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 18, "code_context": "/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 11, "sink_line": 29, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query.name\nSource Type: request_query\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 31\nCode Context:\n/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND ", "label": 0, "source_expression": "req.query.name", "source_type": "request_query", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 31, "code_context": "/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 11, "sink_line": 42, "vulnerability_type": ""}
{"text": "Source: req.query.name\nSource Type: request_query\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 39\nCode Context:\n/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND ", "label": 1, "source_expression": "req.query.name", "source_type": "request_query", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 39, "code_context": "/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 11, "sink_line": 50, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query.name\nSource Type: request_query\nSink: router.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 44\nCode Context:\n/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND ", "label": 1, "source_expression": "req.query.name", "source_type": "request_query", "sink_expression": "router.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 44, "code_context": "/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 11, "sink_line": 55, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query.name\nSource Type: request_query\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 47\nCode Context:\n/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND ", "label": 1, "source_expression": "req.query.name", "source_type": "request_query", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 47, "code_context": "/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 11, "sink_line": 58, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query.name\nSource Type: request_query\nSink: router.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 52\nCode Context:\n/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND ", "label": 1, "source_expression": "req.query.name", "source_type": "request_query", "sink_expression": "router.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 52, "code_context": "/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 11, "sink_line": 63, "vulnerability_type": "CWE-79"}
{"text": "Source: req.query.name\nSource Type: request_query\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 57\nCode Context:\n/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND ", "label": 0, "source_expression": "req.query.name", "source_type": "request_query", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 57, "code_context": "/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 11, "sink_line": 68, "vulnerability_type": ""}
{"text": "Source: req.query.name\nSource Type: request_query\nSink: router.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n \nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 62\nCode Context:\n/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND ", "label": 0, "source_expression": "req.query.name", "source_type": "request_query", "sink_expression": "router.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n ", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 62, "code_context": "/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 11, "sink_line": 73, "vulnerability_type": ""}
{"text": "Source: req.query.name\nSource Type: request_query\nSink: sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 64\nCode Context:\n/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND ", "label": 0, "source_expression": "req.query.name", "source_type": "request_query", "sink_expression": "sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 64, "code_context": "/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 11, "sink_line": 75, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 6\nCode Context:\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 6, "code_context": " */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 19, "sink_line": 13, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: True\nSame File: True\nDistance Lines: 2\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": true, "in_same_file": true, "distance_lines": 2, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 19, "sink_line": 21, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 10\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.sta", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 10, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 19, "sink_line": 29, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 23\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.sta", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 23, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 19, "sink_line": 42, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 31\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.sta", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 31, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 19, "sink_line": 50, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 39\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.sta", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 39, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 19, "sink_line": 58, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 49\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.sta", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 49, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 19, "sink_line": 68, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 56\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.sta", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 56, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 19, "sink_line": 75, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 14\nCode Context:\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 14, "code_context": " */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 27, "sink_line": 13, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 6\nCode Context:\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 6, "code_context": "    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 27, "sink_line": 21, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: True\nSame File: True\nDistance Lines: 2\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": true, "in_same_file": true, "distance_lines": 2, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 27, "sink_line": 29, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 15\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await s", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 15, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 27, "sink_line": 42, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 23\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await s", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 23, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 27, "sink_line": 50, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 31\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await s", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 31, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 27, "sink_line": 58, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 41\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await s", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 41, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 27, "sink_line": 68, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 48\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await s", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 48, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 27, "sink_line": 75, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 26\nCode Context:\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 26, "code_context": " */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 39, "sink_line": 13, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 18\nCode Context:\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.p", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 18, "code_context": "    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 39, "sink_line": 21, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 10\nCode Context:\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE ", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 10, "code_context": "    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 39, "sink_line": 29, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: True\nSame File: True\nDistance Lines: 3\nCode Context:\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": true, "in_same_file": true, "distance_lines": 3, "code_context": "    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 39, "sink_line": 42, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 11\nCode Context:\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 11, "code_context": "    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 39, "sink_line": 50, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 19\nCode Context:\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 19, "code_context": "    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 39, "sink_line": 58, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 29\nCode Context:\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 29, "code_context": "    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 39, "sink_line": 68, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 36\nCode Context:\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 36, "code_context": "    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 39, "sink_line": 75, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 27\nCode Context:\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 27, "code_context": " */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 40, "sink_line": 13, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 19\nCode Context:\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.p", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 19, "code_context": "    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 40, "sink_line": 21, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 11\nCode Context:\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE ", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 11, "code_context": "    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 40, "sink_line": 29, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: True\nSame File: True\nDistance Lines: 2\nCode Context:\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": true, "in_same_file": true, "distance_lines": 2, "code_context": "    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 40, "sink_line": 42, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 10\nCode Context:\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 10, "code_context": "    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 40, "sink_line": 50, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 18\nCode Context:\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 18, "code_context": "    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 40, "sink_line": 58, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 28\nCode Context:\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 28, "code_context": "    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 40, "sink_line": 68, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 35\nCode Context:\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 35, "code_context": "    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 40, "sink_line": 75, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 35\nCode Context:\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 35, "code_context": " */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 48, "sink_line": 13, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 27\nCode Context:\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.p", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 27, "code_context": "    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 48, "sink_line": 21, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 19\nCode Context:\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE ", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 19, "code_context": "    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 48, "sink_line": 29, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 6\nCode Context:\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 6, "code_context": "    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 48, "sink_line": 42, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: True\nSame File: True\nDistance Lines: 2\nCode Context:\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": true, "in_same_file": true, "distance_lines": 2, "code_context": "router.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 48, "sink_line": 50, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 10\nCode Context:\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Stor", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 10, "code_context": "router.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 48, "sink_line": 58, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 20\nCode Context:\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Stor", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 20, "code_context": "router.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 48, "sink_line": 68, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 27\nCode Context:\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Stor", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 27, "code_context": "router.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 48, "sink_line": 75, "vulnerability_type": ""}
{"text": "Source: req.query.sort\nSource Type: request_query\nSink: router.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(qu\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 46\nCode Context:\n/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND ", "label": 1, "source_expression": "req.query.sort", "source_type": "request_query", "sink_expression": "router.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(qu", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 46, "code_context": "/**\n * Users Route - Contains SQL Injection vulnerabilities\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 56, "sink_line": 10, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query.sort\nSource Type: request_query\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 43\nCode Context:\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize", "label": 1, "source_expression": "req.query.sort", "source_type": "request_query", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 43, "code_context": " */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 56, "sink_line": 13, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query.sort\nSource Type: request_query\nSink: router.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(use\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 38\nCode Context:\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.st", "label": 1, "source_expression": "req.query.sort", "source_type": "request_query", "sink_expression": "router.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(use", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 38, "code_context": "\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 56, "sink_line": 18, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query.sort\nSource Type: request_query\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 35\nCode Context:\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.p", "label": 1, "source_expression": "req.query.sort", "source_type": "request_query", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 35, "code_context": "    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 56, "sink_line": 21, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query.sort\nSource Type: request_query\nSink: router.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const \nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 30\nCode Context:\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await ", "label": 1, "source_expression": "req.query.sort", "source_type": "request_query", "sink_expression": "router.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const ", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 30, "code_context": "\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 56, "sink_line": 26, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query.sort\nSource Type: request_query\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 27\nCode Context:\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE ", "label": 1, "source_expression": "req.query.sort", "source_type": "request_query", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 27, "code_context": "    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 56, "sink_line": 29, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query.sort\nSource Type: request_query\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 14\nCode Context:\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio ", "label": 0, "source_expression": "req.query.sort", "source_type": "request_query", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 14, "code_context": "    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 56, "sink_line": 42, "vulnerability_type": ""}
{"text": "Source: req.query.sort\nSource Type: request_query\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 6\nCode Context:\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization", "label": 1, "source_expression": "req.query.sort", "source_type": "request_query", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 6, "code_context": "    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 56, "sink_line": 50, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query.sort\nSource Type: request_query\nSink: router.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 1\nCode Context:\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization", "label": 1, "source_expression": "req.query.sort", "source_type": "request_query", "sink_expression": "router.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 1, "code_context": "\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 56, "sink_line": 55, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query.sort\nSource Type: request_query\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: True\nSame File: True\nDistance Lines: 2\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);", "label": 1, "source_expression": "req.query.sort", "source_type": "request_query", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": true, "in_same_file": true, "distance_lines": 2, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 56, "sink_line": 58, "vulnerability_type": "CWE-89"}
{"text": "Source: req.query.sort\nSource Type: request_query\nSink: router.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio\nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: True\nSame Function: False\nSame File: True\nDistance Lines: 7\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', ", "label": 1, "source_expression": "req.query.sort", "source_type": "request_query", "sink_expression": "router.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": true, "in_same_function": false, "in_same_file": true, "distance_lines": 7, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 56, "sink_line": 63, "vulnerability_type": "CWE-79"}
{"text": "Source: req.query.sort\nSource Type: request_query\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 12\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', ", "label": 0, "source_expression": "req.query.sort", "source_type": "request_query", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 12, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 56, "sink_line": 68, "vulnerability_type": ""}
{"text": "Source: req.query.sort\nSource Type: request_query\nSink: router.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n \nSink Type: url_fetch\nCWE Types: CWE-918\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 17\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', ", "label": 0, "source_expression": "req.query.sort", "source_type": "request_query", "sink_expression": "router.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n ", "sink_type": "url_fetch", "cwe_types": ["CWE-918"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 17, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 56, "sink_line": 73, "vulnerability_type": ""}
{"text": "Source: req.query.sort\nSource Type: request_query\nSink: sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 19\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', ", "label": 0, "source_expression": "req.query.sort", "source_type": "request_query", "sink_expression": "sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 19, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 56, "sink_line": 75, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 51\nCode Context:\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 51, "code_context": " */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 64, "sink_line": 13, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 43\nCode Context:\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.p", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 43, "code_context": "    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 64, "sink_line": 21, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 35\nCode Context:\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE ", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 35, "code_context": "    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 64, "sink_line": 29, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 22\nCode Context:\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio ", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 22, "code_context": "    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 64, "sink_line": 42, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 14\nCode Context:\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 14, "code_context": "    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 64, "sink_line": 50, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 6\nCode Context:\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 6, "code_context": "    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 64, "sink_line": 58, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: True\nSame File: True\nDistance Lines: 4\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": true, "in_same_file": true, "distance_lines": 4, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 64, "sink_line": 68, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 11\nCode Context:\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 11, "code_context": "// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 64, "sink_line": 75, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 52\nCode Context:\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 52, "code_context": " */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 65, "sink_line": 13, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 44\nCode Context:\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.p", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 44, "code_context": "    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 65, "sink_line": 21, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 36\nCode Context:\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE ", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 36, "code_context": "    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 65, "sink_line": 29, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 23\nCode Context:\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio ", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 23, "code_context": "    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 65, "sink_line": 42, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 15\nCode Context:\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 15, "code_context": "    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 65, "sink_line": 50, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 7\nCode Context:\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(", "label": 1, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 7, "code_context": "    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 65, "sink_line": 58, "vulnerability_type": "CWE-89"}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: True\nSame File: True\nDistance Lines: 3\nCode Context:\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": true, "in_same_file": true, "distance_lines": 3, "code_context": "router.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 65, "sink_line": 68, "vulnerability_type": ""}
{"text": "Source: req.body\nSource Type: request_body\nSink: sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 10\nCode Context:\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label": 0, "source_expression": "req.body", "source_type": "request_body", "sink_expression": "sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 10, "code_context": "router.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 65, "sink_line": 75, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 61\nCode Context:\n */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 61, "code_context": " */\n\nconst express = require('express');\nconst router = express.Router();\nconst { sequelize } = require('../models/User');\n\n// VULNERABILITY: CWE-89 - SQL Injection via query parameter (Line 11)\nrouter.get('/search', async (req, res) => {\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 74, "sink_line": 13, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 53\nCode Context:\n    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.p", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 53, "code_context": "    const searchTerm = req.query.name;\n    const query = `SELECT * FROM users WHERE name LIKE '%${searchTerm}%'`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via route parameter (Line 19)\nrouter.get('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 74, "sink_line": 21, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 45\nCode Context:\n    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE ", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 45, "code_context": "    const userId = req.params.id;\n    const query = `SELECT * FROM users WHERE id = ${userId}`;\n    const user = await sequelize.query(query);\n    res.json(user);\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via body parameter (Line 27)\nrouter.post('/login', async (req, res) => {\n    const { username, password } = req.body;\n    const query = `SELECT * FROM users WHERE username = '${username}' AND password = '${password}'`;\n    const users = await sequelize.query(query);\n    if (users.length > 0) {\n        res.json({ success: true, user: users[0] });\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 74, "sink_line": 29, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 32\nCode Context:\n    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio ", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 32, "code_context": "    } else {\n        res.status(401).json({ success: false });\n    }\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in UPDATE (Line 38)\nrouter.put('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 74, "sink_line": 42, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 24\nCode Context:\n    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 24, "code_context": "    const { email } = req.body;\n    const query = `UPDATE users SET email = '${email}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection in DELETE (Line 47)\nrouter.delete('/:id', async (req, res) => {\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 74, "sink_line": 50, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 16\nCode Context:\n    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        '", "label": 1, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 16, "code_context": "    const userId = req.params.id;\n    const query = `DELETE FROM users WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// VULNERABILITY: CWE-89 - SQL Injection via ORDER BY (Line 55)\nrouter.get('/list', async (req, res) => {\n    const sortBy = req.query.sort || 'id';\n    const query = `SELECT * FROM users ORDER BY ${sortBy}`;\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "annotation", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 74, "sink_line": 58, "vulnerability_type": "CWE-89"}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(query)\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: False\nSame File: True\nDistance Lines: 6\nCode Context:\n    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(query)", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": false, "in_same_file": true, "distance_lines": 6, "code_context": "    const users = await sequelize.query(query);\n    res.json(users);\n});\n\n// VULNERABILITY: CWE-79 - Stored XSS via profile bio (Line 63)\nrouter.post('/:id/profile', async (req, res) => {\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 74, "sink_line": 68, "vulnerability_type": ""}
{"text": "Source: req.params.id\nSource Type: request_params\nSink: sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )\nSink Type: sql_query\nCWE Types: CWE-89\nTemplate Literal: False\nSame Function: True\nSame File: True\nDistance Lines: 1\nCode Context:\n    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label": 0, "source_expression": "req.params.id", "source_type": "request_params", "sink_expression": "sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    )", "sink_type": "sql_query", "cwe_types": ["CWE-89"], "uses_template_literal": false, "in_same_function": true, "in_same_file": true, "distance_lines": 1, "code_context": "    const userId = req.params.id;\n    const { bio } = req.body;\n    // Store bio without sanitization\n    const query = `UPDATE users SET bio = '${bio}' WHERE id = ${userId}`;\n    await sequelize.query(query);\n    res.json({ success: true });\n});\n\n// Safe example - Parameterized query (NOT a vulnerability)\nrouter.get('/safe/:id', async (req, res) => {\n    const userId = req.params.id;\n    const user = await sequelize.query(\n        'SELECT * FROM users WHERE id = ?',\n        { replacements: [userId] }\n    );\n    res.json(user);\n});\n\nmodule.exports = router;\n", "label_source": "heuristic", "file_path": "tests/fixtures/vulnerable_express_app/backend/routes/users.js", "source_line": 74, "sink_line": 75, "vulnerability_type": ""}
